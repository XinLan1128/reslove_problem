!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("mp4js",[],t):"object"==typeof exports?exports.mp4js=t():e.mp4js=t()}(window,(function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=11)}([function(e,t,n){"use strict";var i=function(){function e(){}return e.e=function(t,n){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var i="["+t+"] > "+n;e.ENABLE_CALLBACK&&e.emitter.emit("log","error",i),e.ENABLE_ERROR&&(console.error?console.error(i):console.warn?console.warn(i):console.log(i))},e.i=function(t,n){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var i="["+t+"] > "+n;e.ENABLE_CALLBACK&&e.emitter.emit("log","info",i),e.ENABLE_INFO&&(console.info?console.info(i):console.log(i))},e.w=function(t,n){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var i="["+t+"] > "+n;e.ENABLE_CALLBACK&&e.emitter.emit("log","warn",i),e.ENABLE_WARN&&(console.warn?console.warn(i):console.log(i))},e.d=function(t,n){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var i="["+t+"] > "+n;e.ENABLE_CALLBACK&&e.emitter.emit("log","debug",i),e.ENABLE_DEBUG&&(console.debug?console.debug(i):console.log(i))},e.v=function(t,n){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var i="["+t+"] > "+n;e.ENABLE_CALLBACK&&e.emitter.emit("log","verbose",i),e.ENABLE_VERBOSE&&console.log(i)},e}();i.GLOBAL_TAG="wasmPlayer",i.FORCE_GLOBAL_TAG=!1,i.ENABLE_ERROR=!0,i.ENABLE_INFO=!0,i.ENABLE_WARN=!0,i.ENABLE_DEBUG=!0,i.ENABLE_VERBOSE=!0,i.ENABLE_CALLBACK=!1,t.a=i},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}e.exports=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}},function(e,t,n){"use strict";var i,r="object"==typeof Reflect?Reflect:null,a=r&&"function"==typeof r.apply?r.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};i=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(n,i){function r(){void 0!==a&&e.removeListener("error",a),n([].slice.call(arguments))}var a;"error"!==t&&(a=function(n){e.removeListener(t,r),i(n)},e.once("error",a)),e.once(t,r)}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var u=10;function d(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function c(e,t,n,i){var r,a,s,o;if(d(n),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),s=a[t]),void 0===s)s=a[t]=n,++e._eventsCount;else if("function"==typeof s?s=a[t]=i?[n,s]:[s,n]:i?s.unshift(n):s.push(n),(r=l(e))>0&&s.length>r&&!s.warned){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,o=u,console&&console.warn&&console.warn(o)}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=h.bind(i);return r.listener=n,i.wrapFn=r,r}function m(e,t,n){var i=e._events;if(void 0===i)return[];var r=i[t];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):p(r,r.length)}function _(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function p(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");u=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return l(this)},o.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,r=this._events;if(void 0!==r)i=i&&void 0===r.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var u=r[e];if(void 0===u)return!1;if("function"==typeof u)a(u,this,t);else{var d=u.length,l=p(u,d);for(n=0;n<d;++n)a(l[n],this,t)}return!0},o.prototype.addListener=function(e,t){return c(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return c(this,e,t,!0)},o.prototype.once=function(e,t){return d(t),this.on(e,f(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return d(t),this.prependListener(e,f(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,i,r,a,s;if(d(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){s=n[a].listener,r=a;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,a=Object.keys(n);for(i=0;i<a.length;++i)"removeListener"!==(r=a[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},o.prototype.listeners=function(e){return m(this,e,!0)},o.prototype.rawListeners=function(e){return m(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):_.call(e,t)},o.prototype.listenerCount=_,o.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}},function(e,t,n){var i=n(8);e.exports=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,i(e,t)}},function(e,t,n){"use strict";(function(e){var i,r=n(5),a=function(t,n){var a,s;if("worker"!==t){var o=t.lastIndexOf("/");t.slice(o+1),a=t.slice(0,o+1)}function u(){return L.buffer!=C&&X(L.buffer),k}function d(){return L.buffer!=C&&X(L.buffer),x}function l(){return L.buffer!=C&&X(L.buffer),P}function c(){return L.buffer!=C&&X(L.buffer),D}function h(){return L.buffer!=C&&X(L.buffer),O}(n=void 0!==(n=n||{})?n:{}).ready=new Promise((function(e,t){s=e}));var f,m={};for(f in n)n.hasOwnProperty(f)&&(m[f]=n[f]);var _,p,v,g=[],y="./this.program";_="object"==typeof window,p="function"==typeof importScripts,v="object"==typeof e&&"object"==typeof e.versions&&"string"==typeof e.versions.node;var E=n.ENVIRONMENT_IS_PTHREAD||!1;E&&(C=n.buffer,K=n.DYNAMIC_BASE,q=n.DYNAMICTOP_PTR);var b,w="";(_||p)&&(p?w=self.location.href:document.currentScript&&(w=document.currentScript.src),a&&(w=a),w=0!==w.indexOf("blob:")?w.substr(0,w.lastIndexOf("/")+1):"",p&&(b=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}));var S,A,L,T=n.print||console.log.bind(console),B=n.printErr||console.warn.bind(console);for(f in m)m.hasOwnProperty(f)&&(n[f]=m[f]);m=null,n.arguments&&(g=n.arguments),n.thisProgram&&(y=n.thisProgram),n.quit&&n.quit,Atomics.load,Atomics.store,Atomics.compareExchange,n.wasmBinary&&(S=n.wasmBinary),n.noExitRuntime&&(A=n.noExitRuntime),"object"!=typeof WebAssembly&&B("no native wasm support detected");var R,C,k,x,P,D,O,M=new WebAssembly.Table({initial:894,element:"anyfunc"}),U=0,I=0,N=!1;function F(e,t){e||oe("Assertion failed: "+t)}function G(e,t,n){for(var i=t+n,r="";!(t>=i);){var a=e[t++];if(!a)return r;if(128&a){var s=63&e[t++];if(192!=(224&a)){var o=63&e[t++];if((a=224==(240&a)?(15&a)<<12|s<<6|o:(7&a)<<18|s<<12|o<<6|63&e[t++])<65536)r+=String.fromCharCode(a);else{var u=a-65536;r+=String.fromCharCode(55296|u>>10,56320|1023&u)}}else r+=String.fromCharCode((31&a)<<6|s)}else r+=String.fromCharCode(a)}return r}function W(e,t){return e?G(d(),e,t):""}function V(e,t,n,i){if(!(i>0))return 0;for(var r=n,a=n+i-1,s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o>=55296&&o<=57343&&(o=65536+((1023&o)<<10)|1023&e.charCodeAt(++s)),o<=127){if(n>=a)break;t[n++]=o}else if(o<=2047){if(n+1>=a)break;t[n++]=192|o>>6,t[n++]=128|63&o}else if(o<=65535){if(n+2>=a)break;t[n++]=224|o>>12,t[n++]=128|o>>6&63,t[n++]=128|63&o}else{if(n+3>=a)break;t[n++]=240|o>>18,t[n++]=128|o>>12&63,t[n++]=128|o>>6&63,t[n++]=128|63&o}}return t[n]=0,n-r}function H(e,t,n){return V(e,d(),t,n)}function j(e){for(var t=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=55296&&i<=57343&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++n)),i<=127?++t:t+=i<=2047?2:i<=65535?3:4}return t}function z(e){var t=j(e)+1,n=ut(t);return n&&V(e,u(),n,t),n}function X(e){C=e,n.HEAP8=k=new Int8Array(e),n.HEAP16=new Int16Array(e),n.HEAP32=P=new Int32Array(e),n.HEAPU8=x=new Uint8Array(e),n.HEAPU16=new Uint16Array(e),n.HEAPU32=D=new Uint32Array(e),n.HEAPF32=new Float32Array(e),n.HEAPF64=O=new Float64Array(e)}var K=5424688,q=180880,Y=n.INITIAL_MEMORY||134217728;if(E)L=n.wasmMemory,C=n.buffer;else if(n.wasmMemory)L=n.wasmMemory;else if(!((L=new WebAssembly.Memory({initial:Y/65536,maximum:32768,shared:!0})).buffer instanceof SharedArrayBuffer))throw B("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),v&&console.log("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and also use a recent version)"),Error("bad memory");function Z(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var i=t.func;"number"==typeof i?void 0===t.arg?n.dynCall_v(i):n.dynCall_vi(i,t.arg):i(void 0===t.arg?null:t.arg)}else t(n)}}L&&(C=L.buffer),Y=C.byteLength,X(C),E||(l()[q>>2]=K);var Q=[],J=[],$=[],ee=[],te=[],ne=Math.ceil,ie=Math.floor,re=0,ae=null,se=null;function oe(e){throw n.onAbort&&n.onAbort(e),E&&console.error("Pthread aborting at "+(new Error).stack),T(e+=""),B(e),N=!0,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.",new WebAssembly.RuntimeError(e)}function ue(e){return t=e,n="data:application/octet-stream;base64,",String.prototype.startsWith?t.startsWith(n):0===t.indexOf(n);var t,n}n.preloadedImages={},n.preloadedAudios={};var de,le="libffmpegA.wasm";function ce(){try{if(S)return new Uint8Array(S);if(b)return b(le);throw"both async and sync fetching of the wasm failed"}catch(e){oe(e)}}ue(le)||(de=le,le=n.locateFile?n.locateFile(de,w):w+de);var he={1024:function(e,t,i,r,a,s,o,u,d,l){var c,h=new Uint8Array(e),f=0,m=d,_=l;for(c=0;c<_;c++){var p=n.HEAPU8.subarray(t+c*i,t+c*i+m);h.set(p,f),f+=m}for(c=0;c<_/2;c++)p=n.HEAPU8.subarray(r+c*a,r+c*a+m/2),h.set(p,f),f+=m/2;for(c=0;c<_/2;c++)p=n.HEAPU8.subarray(s+c*o,s+c*o+m/2),h.set(p,f),f+=m/2;self.postMessage({cmd:"objectTransfer",w:d,h:l,s:u,d:h},[h.buffer])},141504:function(){throw"Canceled!"},141744:function(e,t){setTimeout((function(){vt(e,t)}),0)}};E||J.push({func:function(){at()}});var fe=0,me=0,_e=0;function pe(e,t,n){fe=e|=0,_e=t|=0,me=n|=0}n.registerPthreadPtr=pe;var ve=71,ge=10,ye=28,Ee=16;function be(e,t){if(e<=0||e>u().length||!0&e||t<0)return-28;if(0==t)return 0;t>=2147483647&&(t=1/0);var n=Atomics.load(l(),45448),i=0;if(n==e&&Atomics.compareExchange(l(),45448,n,0)==n&&(i=1,--t<=0))return 1;var r=Atomics.notify(l(),e>>2,t);if(r>=0)return r+i;throw"Atomics.notify returned an unexpected value "+r}function we(e){if(E)throw"Internal Error! cleanupThread() can only ever be called from main application thread!";if(!e)throw"Internal Error! Null pthread_ptr in cleanupThread!";l()[e+12>>2]=0;var t=Ae.pthreads[e];if(t){var n=t.worker;Ae.returnWorkerToPool(n)}}n._emscripten_futex_wake=be;var Se,Ae={MAIN_THREAD_ID:1,mainThreadInfo:{schedPolicy:0,schedPrio:0},unusedWorkers:[],runningWorkers:[],initRuntime:function(){pe(Ae.mainThreadBlock,!p,1),pt(Ae.mainThreadBlock)},initMainThreadBlock:function(){for(var e=0;e<5;++e)Ae.allocateUnusedWorker();for(Ae.mainThreadBlock=181040,e=0;e<58;++e)c()[Ae.mainThreadBlock/4+e]=0;l()[Ae.mainThreadBlock+12>>2]=Ae.mainThreadBlock;var t=Ae.mainThreadBlock+156;for(l()[t>>2]=t,e=0;e<128;++e)c()[45320+e]=0;Atomics.store(c(),Ae.mainThreadBlock+104>>2,181280),Atomics.store(c(),Ae.mainThreadBlock+40>>2,Ae.mainThreadBlock),Atomics.store(c(),Ae.mainThreadBlock+44>>2,42)},initWorker:function(){},pthreads:{},exitHandlers:null,setThreadStatus:function(){},runExitHandlers:function(){if(null!==Ae.exitHandlers){for(;Ae.exitHandlers.length>0;)Ae.exitHandlers.pop()();Ae.exitHandlers=null}E&&U&&mt()},threadExit:function(e){var t=Je();t&&(Atomics.store(c(),t+4>>2,e),Atomics.store(c(),t+0>>2,1),Atomics.store(c(),t+60>>2,1),Atomics.store(c(),t+64>>2,0),Ae.runExitHandlers(),be(t+0,2147483647),pe(0,0,0),U=0,E&&postMessage({cmd:"exit"}))},threadCancel:function(){Ae.runExitHandlers(),Atomics.store(c(),U+4>>2,-1),Atomics.store(c(),U+0>>2,1),be(U+0,2147483647),U=I=0,pe(0,0,0),postMessage({cmd:"cancelDone"})},terminateAllThreads:function(){for(var e in Ae.pthreads)(i=Ae.pthreads[e])&&i.worker&&Ae.returnWorkerToPool(i.worker);Ae.pthreads={};for(var t=0;t<Ae.unusedWorkers.length;++t)(n=Ae.unusedWorkers[t]).terminate();for(Ae.unusedWorkers=[],t=0;t<Ae.runningWorkers.length;++t){var n,i=(n=Ae.runningWorkers[t]).pthread;Ae.freeThreadData(i),n.terminate()}Ae.runningWorkers=[]},freeThreadData:function(e){if(e){if(e.threadInfoStruct){var t=l()[e.threadInfoStruct+104>>2];l()[e.threadInfoStruct+104>>2]=0,st(t),st(e.threadInfoStruct)}e.threadInfoStruct=0,e.allocatedOwnStack&&e.stackBase&&st(e.stackBase),e.stackBase=0,e.worker&&(e.worker.pthread=null)}},returnWorkerToPool:function(e){delete Ae.pthreads[e.pthread.thread],Ae.unusedWorkers.push(e),Ae.runningWorkers.splice(Ae.runningWorkers.indexOf(e),1),Ae.freeThreadData(e.pthread),e.pthread=void 0},receiveObjectTransfer:function(e){},loadWasmModuleToWorker:function(e,t){e.onmessage=function(n){var i=n.data,r=i.cmd;if(e.pthread&&(Ae.currentProxiedOperationCallerThread=e.pthread.threadInfoStruct),i.targetThread&&i.targetThread!=Je()){var a=Ae.pthreads[i.targetThread];return a?a.worker.postMessage(n.data,i.transferList):console.error('Internal error! Worker sent a message "'+r+'" to target pthread '+i.targetThread+", but that thread no longer exists!"),void(Ae.currentProxiedOperationCallerThread=void 0)}"processQueuedMainThreadWork"===r?_t():"spawnThread"===r?Qe(n.data):"cleanupThread"===r?we(i.thread):"killThread"===r?function(e){if(E)throw"Internal Error! killThread() can only ever be called from main application thread!";if(!e)throw"Internal Error! Null pthread_ptr in killThread!";l()[e+12>>2]=0;var t=Ae.pthreads[e];t.worker.terminate(),Ae.freeThreadData(t),Ae.runningWorkers.splice(Ae.runningWorkers.indexOf(t.worker),1),t.worker.pthread=void 0}(i.thread):"cancelThread"===r?function(e){if(E)throw"Internal Error! cancelThread() can only ever be called from main application thread!";if(!e)throw"Internal Error! Null pthread_ptr in cancelThread!";Ae.pthreads[e].worker.postMessage({cmd:"cancel"})}(i.thread):"loaded"===r?(URL.revokeObjectURL(e.objectURL),e.loaded=!0,t&&t(e),e.runPthread&&(e.runPthread(),delete e.runPthread)):"print"===r?T("Thread "+i.threadId+": "+i.text):"printErr"===r?B("Thread "+i.threadId+": "+i.text):"alert"===r?alert("Thread "+i.threadId+": "+i.text):"exit"===r?e.pthread&&Atomics.load(c(),e.pthread.thread+68>>2)&&Ae.returnWorkerToPool(e):"cancelDone"===r?Ae.returnWorkerToPool(e):"objectTransfer"===r?Ae.receiveObjectTransfer(n.data):"setimmediate"===n.data.target?e.postMessage(n.data):B("worker sent an unknown command "+r),Ae.currentProxiedOperationCallerThread=void 0},e.onerror=function(e){B("pthread sent an error! "+e.filename+":"+e.lineno+": "+e.message)},e.postMessage({cmd:"load",urlOrBlob:n.mainScriptUrlOrBlob||a,wasmMemory:L,wasmModule:R,DYNAMIC_BASE:K,DYNAMICTOP_PTR:q})},allocateUnusedWorker:function(){Ae.unusedWorkers.push(r(9))},getNewWorker:function(){return 0==Ae.unusedWorkers.length&&(Ae.allocateUnusedWorker(),Ae.loadWasmModuleToWorker(Ae.unusedWorkers[0])),Ae.unusedWorkers.length>0?Ae.unusedWorkers.pop():null},busySpinWait:function(e){for(var t=performance.now()+e;performance.now()<t;);}};n.establishStackSpace=function(e,t){St(e)},n.getNoExitRuntime=function(){return A},Se=E?function(){return performance.now()-n.__performance_now_clock_drift}:function(){return performance.now()};var Le={mappings:{},buffers:[null,[],[]],printChar:function(e,t){var n=Le.buffers[e];0===t||10===t?((1===e?T:B)(G(n,0)),n.length=0):n.push(t)},varargs:void 0,get:function(){return Le.varargs+=4,l()[Le.varargs-4>>2]},getStr:function(e){return W(e)},get64:function(e,t){return e}};function Te(e,t,n){return E?xe(1,1,e,t,n):(Le.varargs=n,0)}function Be(e,t,n){if(E)return xe(2,1,e,t,n);Le.varargs=n}function Re(e,t,n){if(E)return xe(3,1,e,t,n)}function Ce(){}function ke(e,t,n){if(e<=0||e>u().length||!0&e)return-28;if(p){var i=Atomics.wait(l(),e>>2,t,n);if("timed-out"===i)return-73;if("not-equal"===i)return-6;if("ok"===i)return 0;throw"Atomics.wait returned an unexpected value "+i}if(t!=Atomics.load(l(),e>>2))return-6;var r=performance.now(),a=r+n;Atomics.store(l(),45448,e);for(var s=e;e==s;){if((r=performance.now())>a)return-73;_t(),e=Atomics.load(l(),45448)}return 0}function xe(e,t){for(var n=arguments.length-2,i=bt(),r=wt(8*n),a=r>>3,s=0;s<n;s++)h()[a+s]=arguments[2+s];var o=yt(e,n,r,t);return St(i),o}var Pe=[];function De(e,t){De.array||(De.array=[]);var n,i=De.array;for(i.length=0;n=d()[e++];)100===n||102===n?(t=t+7&-8,i.push(h()[t>>3]),t+=8):(t=t+3&-4,i.push(l()[t>>2]),t+=4);return i}function Oe(e){try{return L.grow(e-C.byteLength+65535>>>16),X(L.buffer),1}catch(e){}}var Me={keyEvent:0,mouseEvent:0,wheelEvent:0,uiEvent:0,focusEvent:0,deviceOrientationEvent:0,deviceMotionEvent:0,fullscreenChangeEvent:0,pointerlockChangeEvent:0,visibilityChangeEvent:0,touchEvent:0,previousFullscreenElement:null,previousScreenX:null,previousScreenY:null,removeEventListenersRegistered:!1,removeAllEventListeners:function(){for(var e=Me.eventHandlers.length-1;e>=0;--e)Me._removeHandler(e);Me.eventHandlers=[],Me.deferredCalls=[]},registerRemoveEventListeners:function(){Me.removeEventListenersRegistered||(ee.push(Me.removeAllEventListeners),Me.removeEventListenersRegistered=!0)},deferredCalls:[],deferCall:function(e,t,n){function i(e,t){if(e.length!=t.length)return!1;for(var n in e)if(e[n]!=t[n])return!1;return!0}for(var r in Me.deferredCalls){var a=Me.deferredCalls[r];if(a.targetFunction==e&&i(a.argsList,n))return}Me.deferredCalls.push({targetFunction:e,precedence:t,argsList:n}),Me.deferredCalls.sort((function(e,t){return e.precedence<t.precedence}))},removeDeferredCalls:function(e){for(var t=0;t<Me.deferredCalls.length;++t)Me.deferredCalls[t].targetFunction==e&&(Me.deferredCalls.splice(t,1),--t)},canPerformEventHandlerRequests:function(){return Me.inEventHandler&&Me.currentEventHandler.allowsDeferredCalls},runDeferredCalls:function(){if(Me.canPerformEventHandlerRequests())for(var e=0;e<Me.deferredCalls.length;++e){var t=Me.deferredCalls[e];Me.deferredCalls.splice(e,1),--e,t.targetFunction.apply(null,t.argsList)}},inEventHandler:0,currentEventHandler:null,eventHandlers:[],removeAllHandlersOnTarget:function(e,t){for(var n=0;n<Me.eventHandlers.length;++n)Me.eventHandlers[n].target!=e||t&&t!=Me.eventHandlers[n].eventTypeString||Me._removeHandler(n--)},_removeHandler:function(e){var t=Me.eventHandlers[e];t.target.removeEventListener(t.eventTypeString,t.eventListenerFunc,t.useCapture),Me.eventHandlers.splice(e,1)},registerOrRemoveHandler:function(e){var t=function(t){++Me.inEventHandler,Me.currentEventHandler=e,Me.runDeferredCalls(),e.handlerFunc(t),Me.runDeferredCalls(),--Me.inEventHandler};if(e.callbackfunc)e.eventListenerFunc=t,e.target.addEventListener(e.eventTypeString,t,e.useCapture),Me.eventHandlers.push(e),Me.registerRemoveEventListeners();else for(var n=0;n<Me.eventHandlers.length;++n)Me.eventHandlers[n].target==e.target&&Me.eventHandlers[n].eventTypeString==e.eventTypeString&&Me._removeHandler(n--)},queueEventHandlerOnThread_iiii:function(e,t,n,i,r){var a=bt(),s=wt(12);l()[s>>2]=n,l()[s+4>>2]=i,l()[s+8>>2]=r,Et(0,e,637534208,t,i,s),St(a)},getTargetThreadForEventCallback:function(e){switch(e){case 1:return 0;case 2:return Ae.currentProxiedOperationCallerThread;default:return e}},getNodeNameForTarget:function(e){return e?e==window?"#window":e==screen?"#screen":e&&e.nodeName?e.nodeName:"":""},fullscreenEnabled:function(){return document.fullscreenEnabled||document.webkitFullscreenEnabled}};function Ue(e,t,n,i){var r,a,s,o=bt(),u=wt(12),d=0;t&&(a=j(r=t)+1,s=ut(a),H(r,s,a),d=s),l()[u>>2]=d,l()[u+4>>2]=n,l()[u+8>>2]=i,Et(0,e,657457152,0,d,u),St(o)}var Ie=[0,"undefined"!=typeof document?document:0,"undefined"!=typeof window?window:0];function Ne(e){var t;return e=(t=e)>2?W(t):t,Ie[e]||("undefined"!=typeof document?document.querySelector(e):void 0)}function Fe(e){return Ne(e)}function Ge(e,t,n){var i=Fe(e);if(!i)return-4;if(i.canvasSharedPtr&&(l()[i.canvasSharedPtr>>2]=t,l()[i.canvasSharedPtr+4>>2]=n),!i.offscreenCanvas&&i.controlTransferredOffscreen)return i.canvasSharedPtr?(function(e,t,n,i){Ue(e,t=t?W(t):"",n,i)}(l()[i.canvasSharedPtr+8>>2],e,t,n),1):-4;i.offscreenCanvas&&(i=i.offscreenCanvas);var r=!1;if(i.GLctxObject&&i.GLctxObject.GLctx){var a=i.GLctxObject.GLctx.getParameter(2978);r=0===a[0]&&0===a[1]&&a[2]===i.width&&a[3]===i.height}return i.width=t,i.height=n,r&&i.GLctxObject.GLctx.viewport(0,0,t,n),0}function We(e,t,n){return E?xe(4,1,e,t,n):Ge(e,t,n)}var Ve,He={counter:1,lastError:0,buffers:[],mappedBuffers:{},programs:[],framebuffers:[],renderbuffers:[],textures:[],uniforms:[],shaders:[],vaos:[],contexts:{},currentContext:null,offscreenCanvases:{},timerQueriesEXT:[],programInfos:{},stringCache:{},unpackAlignment:4,init:function(){for(var e=new Float32Array(He.MINI_TEMP_BUFFER_SIZE),t=0;t<He.MINI_TEMP_BUFFER_SIZE;t++)He.miniTempBufferFloatViews[t]=e.subarray(0,t+1);var n=new Int32Array(He.MINI_TEMP_BUFFER_SIZE);for(t=0;t<He.MINI_TEMP_BUFFER_SIZE;t++)He.miniTempBufferIntViews[t]=n.subarray(0,t+1)},recordError:function(e){He.lastError||(He.lastError=e)},getNewId:function(e){for(var t=He.counter++,n=e.length;n<t;n++)e[n]=null;return t},MINI_TEMP_BUFFER_SIZE:256,miniTempBufferFloatViews:[0],miniTempBufferIntViews:[0],getSource:function(e,t,n,i){for(var r="",a=0;a<t;++a){var s=i?l()[i+4*a>>2]:-1;r+=W(l()[n+4*a>>2],s<0?void 0:s)}return r},createContext:function(e,t){var n=e.getContext("webgl",t);return n?He.registerContext(n,t):0},registerContext:function(e,t){var n=ut(8);l()[n+4>>2]=Je();var i={handle:n,attributes:t,version:t.majorVersion,GLctx:e};return e.canvas&&(e.canvas.GLctxObject=i),He.contexts[n]=i,(void 0===t.enableExtensionsByDefault||t.enableExtensionsByDefault)&&He.initExtensions(i),n},makeContextCurrent:function(e){return He.currentContext=He.contexts[e],n.ctx=Ve=He.currentContext&&He.currentContext.GLctx,!(e&&!Ve)},getContext:function(e){return He.contexts[e]},deleteContext:function(e){He.currentContext===He.contexts[e]&&(He.currentContext=null),"object"==typeof Me&&Me.removeAllHandlersOnTarget(He.contexts[e].GLctx.canvas),He.contexts[e]&&He.contexts[e].GLctx.canvas&&(He.contexts[e].GLctx.canvas.GLctxObject=void 0),st(He.contexts[e].handle),He.contexts[e]=null},initExtensions:function(e){if(e||(e=He.currentContext),!e.initExtensionsDone){e.initExtensionsDone=!0;var t=e.GLctx;(r=(i=t).getExtension("ANGLE_instanced_arrays"))&&(i.vertexAttribDivisor=function(e,t){r.vertexAttribDivisorANGLE(e,t)},i.drawArraysInstanced=function(e,t,n,i){r.drawArraysInstancedANGLE(e,t,n,i)},i.drawElementsInstanced=function(e,t,n,i,a){r.drawElementsInstancedANGLE(e,t,n,i,a)}),function(e){var t=e.getExtension("OES_vertex_array_object");t&&(e.createVertexArray=function(){return t.createVertexArrayOES()},e.deleteVertexArray=function(e){t.deleteVertexArrayOES(e)},e.bindVertexArray=function(e){t.bindVertexArrayOES(e)},e.isVertexArray=function(e){return t.isVertexArrayOES(e)})}(t),function(e){var t=e.getExtension("WEBGL_draw_buffers");t&&(e.drawBuffers=function(e,n){t.drawBuffersWEBGL(e,n)})}(t),t.disjointTimerQueryExt=t.getExtension("EXT_disjoint_timer_query");var n=["OES_texture_float","OES_texture_half_float","OES_standard_derivatives","OES_vertex_array_object","WEBGL_compressed_texture_s3tc","WEBGL_depth_texture","OES_element_index_uint","EXT_texture_filter_anisotropic","EXT_frag_depth","WEBGL_draw_buffers","ANGLE_instanced_arrays","OES_texture_float_linear","OES_texture_half_float_linear","EXT_blend_minmax","EXT_shader_texture_lod","EXT_texture_norm16","WEBGL_compressed_texture_pvrtc","EXT_color_buffer_half_float","WEBGL_color_buffer_float","EXT_sRGB","WEBGL_compressed_texture_etc1","EXT_disjoint_timer_query","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_astc","EXT_color_buffer_float","WEBGL_compressed_texture_s3tc_srgb","EXT_disjoint_timer_query_webgl2","WEBKIT_WEBGL_compressed_texture_pvrtc"];(t.getSupportedExtensions()||[]).forEach((function(e){-1!=n.indexOf(e)&&t.getExtension(e)}))}var i,r},populateUniformTable:function(e){for(var t=He.programs[e],n=He.programInfos[e]={uniforms:{},maxUniformLength:0,maxAttributeLength:-1,maxUniformBlockNameLength:-1},i=n.uniforms,r=Ve.getProgramParameter(t,35718),a=0;a<r;++a){var s=Ve.getActiveUniform(t,a),o=s.name;n.maxUniformLength=Math.max(n.maxUniformLength,o.length+1),"]"==o.slice(-1)&&(o=o.slice(0,o.lastIndexOf("[")));var u=Ve.getUniformLocation(t,o);if(u){var d=He.getNewId(He.uniforms);i[o]=[s.size,d],He.uniforms[d]=u;for(var l=1;l<s.size;++l){var c=o+"["+l+"]";u=Ve.getUniformLocation(t,c),d=He.getNewId(He.uniforms),He.uniforms[d]=u}}}}},je=["default","low-power","high-performance"],ze={};function Xe(){if(!Xe.strings){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:y||"./this.program"};for(var t in ze)e[t]=ze[t];var n=[];for(var t in e)n.push(t+"="+e[t]);Xe.strings=n}return Xe.strings}function Ke(e){return E?xe(5,1,e):0}function qe(e,t){if(E)return xe(6,1,e,t);var n=1==e||2==e?2:oe();return u()[t>>0]=n,0}function Ye(e,t,n,i,r){if(E)return xe(7,1,e,t,n,i,r)}function Ze(e,t,n,i){if(E)return xe(8,1,e,t,n,i);for(var r=0,a=0;a<n;a++){for(var s=l()[t+8*a>>2],o=l()[t+(8*a+4)>>2],u=0;u<o;u++)Le.printChar(e,d()[s+u]);r+=o}return l()[i>>2]=r,0}function Qe(e){if(E)throw"Internal Error! spawnThread() can only ever be called from main application thread!";var t=Ae.getNewWorker();if(void 0!==t.pthread)throw"Internal error!";if(!e.pthread_ptr)throw"Internal error, no pthread ptr!";Ae.runningWorkers.push(t);for(var n=ut(512),i=0;i<128;++i)l()[n+4*i>>2]=0;var r=e.stackBase+e.stackSize,a=Ae.pthreads[e.pthread_ptr]={worker:t,stackBase:e.stackBase,stackSize:e.stackSize,allocatedOwnStack:e.allocatedOwnStack,thread:e.pthread_ptr,threadInfoStruct:e.pthread_ptr},s=a.threadInfoStruct>>2;Atomics.store(c(),s+0,0),Atomics.store(c(),s+1,0),Atomics.store(c(),s+2,0),Atomics.store(c(),s+17,e.detached),Atomics.store(c(),s+26,n),Atomics.store(c(),s+12,0),Atomics.store(c(),s+10,a.threadInfoStruct),Atomics.store(c(),s+11,42),Atomics.store(c(),s+27,e.stackSize),Atomics.store(c(),s+21,e.stackSize),Atomics.store(c(),s+20,r),Atomics.store(c(),s+29,r),Atomics.store(c(),s+30,e.detached),Atomics.store(c(),s+32,e.schedPolicy),Atomics.store(c(),s+33,e.schedPrio);var o=dt()+40;Atomics.store(c(),s+44,o),t.pthread=a;var u={cmd:"run",start_routine:e.startRoutine,arg:e.arg,threadInfoStruct:e.pthread_ptr,selfThreadId:e.pthread_ptr,parentThreadId:e.parent_pthread_ptr,stackBase:e.stackBase,stackSize:e.stackSize};t.runPthread=function(){u.time=performance.now(),t.postMessage(u,e.transferList)},t.loaded&&(t.runPthread(),delete t.runPthread)}function Je(){return 0|fe}function $e(){if(E&&U&&!Atomics.load(c(),U+60>>2)&&2==Atomics.load(c(),U+0>>2))throw"Canceled!"}function et(e){if(E)return xe(10,1,e);switch(e){case 30:return 16384;case 85:return 131072;case 132:case 133:case 12:case 137:case 138:case 15:case 235:case 16:case 17:case 18:case 19:case 20:case 149:case 13:case 10:case 236:case 153:case 9:case 21:case 22:case 159:case 154:case 14:case 77:case 78:case 139:case 80:case 81:case 82:case 68:case 67:case 164:case 11:case 29:case 47:case 48:case 95:case 52:case 51:case 46:case 79:return 200809;case 27:case 246:case 127:case 128:case 23:case 24:case 160:case 161:case 181:case 182:case 242:case 183:case 184:case 243:case 244:case 245:case 165:case 178:case 179:case 49:case 50:case 168:case 169:case 175:case 170:case 171:case 172:case 97:case 76:case 32:case 173:case 35:return-1;case 176:case 177:case 7:case 155:case 8:case 157:case 125:case 126:case 92:case 93:case 129:case 130:case 131:case 94:case 91:return 1;case 74:case 60:case 69:case 70:case 4:return 1024;case 31:case 42:case 72:return 32;case 87:case 26:case 33:return 2147483647;case 34:case 1:return 47839;case 38:case 36:return 99;case 43:case 37:return 2048;case 0:return 2097152;case 3:return 65536;case 28:return 32768;case 44:return 32767;case 75:return 16384;case 39:return 1e3;case 89:return 700;case 71:return 256;case 40:return 255;case 2:return 100;case 180:return 64;case 25:return 20;case 5:return 16;case 6:return 6;case 73:return 4;case 84:return"object"==typeof navigator&&navigator.hardwareConcurrency||1}var t;return t=28,l()[ot()>>2]=t,-1}H("GMT",180944,4),n._pthread_self=Je,E?Ae.initWorker():Ae.initMainThreadBlock(),He.init();var tt=[null,Te,Be,Re,We,Ke,qe,Ye,Ze,function e(){if(E)return xe(9,1);if(!e.called){e.called=!0,l()[ht()>>2]=60*(new Date).getTimezoneOffset();var t=(new Date).getFullYear(),n=new Date(t,0,1),i=new Date(t,6,1);l()[ct()>>2]=Number(n.getTimezoneOffset()!=i.getTimezoneOffset());var r=u(n),a=u(i),s=z(r),o=z(a);i.getTimezoneOffset()<n.getTimezoneOffset()?(l()[lt()>>2]=s,l()[lt()+4>>2]=o):(l()[lt()>>2]=o,l()[lt()+4>>2]=s)}function u(e){var t=e.toTimeString().match(/\(([A-Za-z ]+)\)$/);return t?t[1]:"GMT"}},et],nt={d:function(e,t,n,i){oe("Assertion failed: "+W(e)+", at: "+[t?W(t):"unknown filename",n,i?W(i):"unknown function"])},o:Te,J:Be,I:Re,z:function(e,t){if(e==t)postMessage({cmd:"processQueuedMainThreadWork"});else if(E)postMessage({targetThread:e,cmd:"processThreadQueue"});else{var n=Ae.pthreads[e],i=n&&n.worker;if(!i)return;i.postMessage({cmd:"processThreadQueue"})}return 1},a:function(){oe()},q:function e(){return void 0===e.start&&(e.start=Date.now()),1e3*(Date.now()-e.start)|0},g:function(e,t,n){var i=De(t,n);return he[e].apply(null,i)},D:Ce,n:function(e,t){},e:ke,c:be,h:Se,f:function(){return 0|_e},A:function(){return 0|me},u:function(e,t,n){d().copyWithin(e,t,t+n)},v:function(e,t,n){Pe.length=t;for(var i=n>>3,r=0;r<t;r++)Pe[r]=h()[i+r];var a=e<0,s=a?he[-e-1]:tt[e];if(a){var o=De(Pe[1],Pe[2]);return s.apply(null,o)}return s.apply(null,Pe)},E:function(e){e>>>=0;var t=d().length;if(e<=t)return!1;if(e>2147483648)return!1;for(var n,i,r=1;r<=4;r*=2){var a=t*(1+.2/r);if(a=Math.min(a,e+100663296),Oe(Math.min(2147483648,((n=Math.max(16777216,e,a))%(i=65536)>0&&(n+=i-n%i),n))))return!0}return!1},w:function(e,t,n){return Fe(e)?Ge(e,t,n):We(e,t,n)},m:function(e){},y:function(e,t){return function(e,t){var n={},i=t>>2;n.alpha=!!l()[i+0],n.depth=!!l()[i+1],n.stencil=!!l()[i+2],n.antialias=!!l()[i+3],n.premultipliedAlpha=!!l()[i+4],n.preserveDrawingBuffer=!!l()[i+5];var r=l()[i+6];n.powerPreference=je[r],n.failIfMajorPerformanceCaveat=!!l()[i+7],n.majorVersion=l()[i+8],n.minorVersion=l()[i+9],n.enableExtensionsByDefault=l()[i+10],n.explicitSwapControl=l()[i+11],n.proxyContextToMainThread=l()[i+12],n.renderViaOffscreenBackBuffer=l()[i+13];var a=Fe(e);return a?n.explicitSwapControl?-1:He.createContext(a,n):-4}(e,t)},F:function(e,t){var n=0;return Xe().forEach((function(i,r){var a=t+n;l()[e+4*r>>2]=a,function(e,t,n){for(var i=0;i<e.length;++i)u()[t++>>0]=e.charCodeAt(i);n||(u()[t>>0]=0)}(i,a),n+=i.length+1})),0},G:function(e,t){var n=Xe();l()[e>>2]=n.length;var i=0;return n.forEach((function(e){i+=e.length+1})),l()[t>>2]=i,0},l:Ke,H:qe,s:Ye,k:Ze,p:function(e){var t=Date.now();return l()[e>>2]=t/1e3|0,l()[e+4>>2]=t%1e3*1e3|0,0},t:function(){Ae.initRuntime()},memory:L||n.wasmMemory,B:function(e){var t=Ae.exitHandlers.pop();e&&t()},C:function(e,t){null===Ae.exitHandlers&&(Ae.exitHandlers=[]),Ae.exitHandlers.push((function(){At(e,t)}))},j:function(e,t,n,i){if("undefined"==typeof SharedArrayBuffer)return B("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;if(!e)return B("pthread_create called with a null thread pointer!"),28;var r=[];if(E&&0===r.length)return gt(687865856,e,t,n,i);var a=0,s=0,o=0,u=0,d=0;if(t)if(a=l()[t>>2],a+=81920,s=l()[t+8>>2],o=0!==l()[t+12>>2],0===l()[t+16>>2]){var h=l()[t+20>>2],f=l()[t+24>>2];!function(e,t,n){if(!t&&!n)return ye;if(!e)return B("pthread_getschedparam called with a null thread pointer!"),ve;if(l()[e+12>>2]!==e)return B("pthread_getschedparam attempted on thread "+e+", which does not point to a valid thread, or does not exist anymore!"),ve;var i=Atomics.load(c(),e+108+20>>2),r=Atomics.load(c(),e+108+24>>2);t&&(l()[t>>2]=i),n&&(l()[n>>2]=r)}(Ae.currentProxiedOperationCallerThread?Ae.currentProxiedOperationCallerThread:Je(),t+20,t+24),u=l()[t+20>>2],d=l()[t+24>>2],l()[t+20>>2]=h,l()[t+24>>2]=f}else u=l()[t+20>>2],d=l()[t+24>>2];else a=2097152;var m=0==s;m?s=ft(16,a):F((s-=a)>0);for(var _=ut(232),p=0;p<58;++p)c()[(_>>2)+p]=0;l()[e>>2]=_,l()[_+12>>2]=_;var v=_+156;l()[v>>2]=v;var g={stackBase:s,stackSize:a,allocatedOwnStack:m,schedPolicy:u,schedPrio:d,detached:o,startRoutine:n,pthread_ptr:_,parent_pthread_ptr:Je(),arg:i,transferList:r};return E?(g.cmd="spawnThread",postMessage(g,r)):Qe(g),0},i:function(e,t){return function(e,t,n){if(!e)return B("pthread_join attempted on a null thread pointer!"),ve;if(E&&I==e)return B("PThread "+e+" is attempting to join to itself!"),Ee;if(!E&&Ae.mainThreadBlock==e)return B("Main thread "+e+" is attempting to join to itself!"),Ee;if(l()[e+12>>2]!==e)return B("pthread_join attempted on thread "+e+", which does not point to a valid thread, or does not exist anymore!"),ve;if(Atomics.load(c(),e+68>>2))return B("Attempted to join thread "+e+", which was already detached!"),ye;for(;;){var i=Atomics.load(c(),e+0>>2);if(1==i){var r=Atomics.load(c(),e+4>>2);return t&&(l()[t>>2]=r),Atomics.store(c(),e+68>>2,1),E?postMessage({cmd:"cleanupThread",thread:e}):we(e),0}if(!n)return ge;$e(),E||_t(),ke(e+0,i,E?100:1)}}(e,t,!0)},b:Je,r:function(e){return(e=+e)>=0?+ie(e+.5):+ne(e-.5)},x:et,table:M},it=function(){var e={a:nt};function t(e,t){var r=e.exports;if(n.asm=r,R=i||t,i=i||t,!E){var a=Ae.unusedWorkers.length;Ae.unusedWorkers.forEach((function(e){Ae.loadWasmModuleToWorker(e,(function(){--a||function(e){if(re--,n.monitorRunDependencies&&n.monitorRunDependencies(re),0==re&&(null!==ae&&(clearInterval(ae),ae=null),se)){var t=se;se=null,t()}}()}))}))}}function r(e){t(e.instance,e.module)}function a(t){return(S||!_&&!p||"function"!=typeof fetch?new Promise((function(e,t){e(ce())})):fetch(le,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+le+"'";return e.arrayBuffer()})).catch((function(){return ce()}))).then((function(t){return WebAssembly.instantiate(t,e)})).then(t,(function(e){B("failed to asynchronously prepare wasm: "+e),oe(e)}))}if(E||(F(!E,"addRunDependency cannot be used in a pthread worker"),re++,n.monitorRunDependencies&&n.monitorRunDependencies(re)),n.instantiateWasm)try{return n.instantiateWasm(e,t)}catch(e){return B("Module.instantiateWasm callback failed with error: "+e),!1}return i?(WebAssembly.instantiate(i,e).then(t,(function(e){B("failed to asynchronously prepare wasm: "+e),oe(e)})),{}):(function(){if(S||"function"!=typeof WebAssembly.instantiateStreaming||ue(le)||"function"!=typeof fetch)return a(r);fetch(le,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(r,(function(e){a(r)}))}))}(),{})}();n.asm=it;var rt,at=n.___wasm_call_ctors=function(){return(at=n.___wasm_call_ctors=n.asm.K).apply(null,arguments)},st=(n._createNewSwsCTX=function(){return(n._createNewSwsCTX=n.asm.L).apply(null,arguments)},n._free=function(){return(st=n._free=n.asm.M).apply(null,arguments)}),ot=(n._destroyAllDecoders=function(){return(n._destroyAllDecoders=n.asm.N).apply(null,arguments)},n._createVideoDecoder=function(){return(n._createVideoDecoder=n.asm.O).apply(null,arguments)},n._sendAframe=function(){return(n._sendAframe=n.asm.P).apply(null,arguments)},n._startDecoding=function(){return(n._startDecoding=n.asm.Q).apply(null,arguments)},n._pauseDecoding=function(){return(n._pauseDecoding=n.asm.R).apply(null,arguments)},n._doResize=function(){return(n._doResize=n.asm.S).apply(null,arguments)},n._cleanFifo=function(){return(n._cleanFifo=n.asm.T).apply(null,arguments)},n._setLog=function(){return(n._setLog=n.asm.U).apply(null,arguments)},n.___errno_location=function(){return(ot=n.___errno_location=n.asm.V).apply(null,arguments)}),ut=n._malloc=function(){return(ut=n._malloc=n.asm.W).apply(null,arguments)},dt=n._emscripten_get_global_libc=function(){return(dt=n._emscripten_get_global_libc=n.asm.X).apply(null,arguments)},lt=(n.___em_js__initPthreadsJS=function(){return(n.___em_js__initPthreadsJS=n.asm.Y).apply(null,arguments)},n.__get_tzname=function(){return(lt=n.__get_tzname=n.asm.Z).apply(null,arguments)}),ct=n.__get_daylight=function(){return(ct=n.__get_daylight=n.asm._).apply(null,arguments)},ht=n.__get_timezone=function(){return(ht=n.__get_timezone=n.asm.$).apply(null,arguments)},ft=n._memalign=function(){return(ft=n._memalign=n.asm.aa).apply(null,arguments)},mt=(n._emscripten_main_browser_thread_id=function(){return(n._emscripten_main_browser_thread_id=n.asm.ba).apply(null,arguments)},n.___pthread_tsd_run_dtors=function(){return(mt=n.___pthread_tsd_run_dtors=n.asm.ca).apply(null,arguments)}),_t=n._emscripten_main_thread_process_queued_calls=function(){return(_t=n._emscripten_main_thread_process_queued_calls=n.asm.da).apply(null,arguments)},pt=(n._emscripten_current_thread_process_queued_calls=function(){return(n._emscripten_current_thread_process_queued_calls=n.asm.ea).apply(null,arguments)},n._emscripten_register_main_browser_thread_id=function(){return(pt=n._emscripten_register_main_browser_thread_id=n.asm.fa).apply(null,arguments)}),vt=n._do_emscripten_dispatch_to_thread=function(){return(vt=n._do_emscripten_dispatch_to_thread=n.asm.ga).apply(null,arguments)},gt=(n._emscripten_async_run_in_main_thread=function(){return(n._emscripten_async_run_in_main_thread=n.asm.ha).apply(null,arguments)},n._emscripten_sync_run_in_main_thread=function(){return(n._emscripten_sync_run_in_main_thread=n.asm.ia).apply(null,arguments)},n._emscripten_sync_run_in_main_thread_0=function(){return(n._emscripten_sync_run_in_main_thread_0=n.asm.ja).apply(null,arguments)},n._emscripten_sync_run_in_main_thread_1=function(){return(n._emscripten_sync_run_in_main_thread_1=n.asm.ka).apply(null,arguments)},n._emscripten_sync_run_in_main_thread_2=function(){return(n._emscripten_sync_run_in_main_thread_2=n.asm.la).apply(null,arguments)},n._emscripten_sync_run_in_main_thread_xprintf_varargs=function(){return(n._emscripten_sync_run_in_main_thread_xprintf_varargs=n.asm.ma).apply(null,arguments)},n._emscripten_sync_run_in_main_thread_3=function(){return(n._emscripten_sync_run_in_main_thread_3=n.asm.na).apply(null,arguments)},n._emscripten_sync_run_in_main_thread_4=function(){return(gt=n._emscripten_sync_run_in_main_thread_4=n.asm.oa).apply(null,arguments)}),yt=(n._emscripten_sync_run_in_main_thread_5=function(){return(n._emscripten_sync_run_in_main_thread_5=n.asm.pa).apply(null,arguments)},n._emscripten_sync_run_in_main_thread_6=function(){return(n._emscripten_sync_run_in_main_thread_6=n.asm.qa).apply(null,arguments)},n._emscripten_sync_run_in_main_thread_7=function(){return(n._emscripten_sync_run_in_main_thread_7=n.asm.ra).apply(null,arguments)},n._emscripten_run_in_main_runtime_thread_js=function(){return(yt=n._emscripten_run_in_main_runtime_thread_js=n.asm.sa).apply(null,arguments)}),Et=n.__emscripten_call_on_thread=function(){return(Et=n.__emscripten_call_on_thread=n.asm.ta).apply(null,arguments)},bt=(n._emscripten_tls_init=function(){return(n._emscripten_tls_init=n.asm.ua).apply(null,arguments)},n.stackSave=function(){return(bt=n.stackSave=n.asm.va).apply(null,arguments)}),wt=n.stackAlloc=function(){return(wt=n.stackAlloc=n.asm.wa).apply(null,arguments)},St=n.stackRestore=function(){return(St=n.stackRestore=n.asm.xa).apply(null,arguments)},At=(n.dynCall_ii=function(){return(n.dynCall_ii=n.asm.ya).apply(null,arguments)},n.dynCall_v=function(){return(n.dynCall_v=n.asm.za).apply(null,arguments)},n.dynCall_vi=function(){return(At=n.dynCall_vi=n.asm.Aa).apply(null,arguments)});function Lt(e){function t(){rt||(rt=!0,n.calledRun=!0,N||(Z(J),E||Z($),s(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),function(){if(!E){if(n.postRun)for("function"==typeof n.postRun&&(n.postRun=[n.postRun]);n.postRun.length;)e=n.postRun.shift(),te.unshift(e);var e;Z(te)}}()))}e=e||g,re>0||(function(){if(!E){if(n.preRun)for("function"==typeof n.preRun&&(n.preRun=[n.preRun]);n.preRun.length;)e=n.preRun.shift(),Q.unshift(e);var e;Z(Q)}}(),re>0||(n.setStatus?(n.setStatus("Running..."),setTimeout((function(){setTimeout((function(){n.setStatus("")}),1),t()}),1)):t()))}if(n._ff_h264_cabac_tables=40442,n.asm=it,n.PThread=Ae,n.PThread=Ae,n._pthread_self=Je,n.wasmMemory=L,n.ExitStatus=function(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e},se=function e(){rt||Lt(),rt||(se=e)},n.run=Lt,n.preInit)for("function"==typeof n.preInit&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return E||(A=!0),E?s(n):Lt(),n.ready};t.a=a}).call(this,n(6))},function(e,t,n){function i(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n.oe=function(e){throw console.error(e),e};var i=n(n.s=ENTRY_MODULE);return i.default||i}function r(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function a(e,t,i){var a={};a[i]=[];var s=t.toString(),o=s.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!o)return a;for(var u,d=o[1],l=new RegExp("(\\\\n|\\W)"+r(d)+"\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)","g");u=l.exec(s);)"dll-reference"!==u[3]&&a[i].push(u[3]);for(l=new RegExp("\\("+r(d)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)',"g");u=l.exec(s);)e[u[2]]||(a[i].push(u[1]),e[u[2]]=n(u[1]).m),a[u[2]]=a[u[2]]||[],a[u[2]].push(u[4]);for(var c,h=Object.keys(a),f=0;f<h.length;f++)for(var m=0;m<a[h[f]].length;m++)c=a[h[f]][m],isNaN(1*c)||(a[h[f]][m]=1*a[h[f]][m]);return a}function s(e){return Object.keys(e).reduce((function(t,n){return t||e[n].length>0}),!1)}e.exports=function(e,t){t=t||{};var r={main:n.m},o=t.all?{main:Object.keys(r.main)}:function(e,t){for(var n={main:[t]},i={main:[]},r={main:{}};s(n);)for(var o=Object.keys(n),u=0;u<o.length;u++){var d=o[u],l=n[d].pop();if(r[d]=r[d]||{},!r[d][l]&&e[d][l]){r[d][l]=!0,i[d]=i[d]||[],i[d].push(l);for(var c=a(e,e[d][l],d),h=Object.keys(c),f=0;f<h.length;f++)n[h[f]]=n[h[f]]||[],n[h[f]]=n[h[f]].concat(c[h[f]])}}return i}(r,e),u="";Object.keys(o).filter((function(e){return"main"!==e})).forEach((function(e){for(var t=0;o[e][t];)t++;o[e].push(t),r[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",u=u+"var "+e+" = ("+i.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+o[e].map((function(t){return JSON.stringify(t)+": "+r[e][t].toString()})).join(",")+"});\n"})),u=u+"new (("+i.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+o.main.map((function(e){return JSON.stringify(e)+": "+r.main[e].toString()})).join(",")+"}))(self);";var d=new window.Blob([u],{type:"text/javascript"});if(t.bare)return d;var l=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(d),c=new window.Worker(l);return c.objectURL=l,c}},function(e,t){var n,i,r=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}}();var u,d=[],l=!1,c=-1;function h(){l&&u&&(l=!1,u.length?d=u.concat(d):c=-1,d.length&&f())}function f(){if(!l){var e=o(h);l=!0;for(var t=d.length;t;){for(u=d,d=[];++c<t;)u&&u[c].run();c=-1,t=d.length}u=null,l=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function _(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new m(e,t)),1!==d.length||l||o(f)},m.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=_,r.addListener=_,r.once=_,r.off=_,r.removeListener=_,r.removeAllListeners=_,r.emit=_,r.prependListener=_,r.prependOnceListener=_,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,n){"use strict";(function(e){var n=function(t,n){var i,r;if("worker"!==t){var a=t.lastIndexOf("/");t.slice(a+1),i=t.slice(0,a+1)}(n=void 0!==(n=n||{})?n:{}).ready=new Promise((function(e,t){r=e}));var s,o={};for(s in n)n.hasOwnProperty(s)&&(o[s]=n[s]);var u,d,l=[],c="./this.program";u="object"==typeof window,d="function"==typeof importScripts,"object"==typeof e&&"object"==typeof e.versions&&"string"==typeof e.versions.node;var h,f="";(u||d)&&(d?f=self.location.href:document.currentScript&&(f=document.currentScript.src),i&&(f=i),f=0!==f.indexOf("blob:")?f.substr(0,f.lastIndexOf("/")+1):"",d&&(h=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}));var m=n.print||console.log.bind(console),_=n.printErr||console.warn.bind(console);for(s in o)o.hasOwnProperty(s)&&(n[s]=o[s]);o=null,n.arguments&&(l=n.arguments),n.thisProgram&&(c=n.thisProgram),n.quit&&n.quit;var p,v,g,y=[];function E(e,t){var n,i=L;if(!p){p=new WeakMap;for(var r=0;r<i.length;r++){var a=i.get(r);a&&p.set(a,r)}}if(p.has(e))return p.get(e);if(y.length)n=y.pop();else{n=i.length;try{i.grow(1)}catch(e){if(!(e instanceof RangeError))throw e;throw"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH."}}try{i.set(n,e)}catch(r){if(!(r instanceof TypeError))throw r;var s=function(e,t){if("function"==typeof WebAssembly.Function){for(var n={i:"i32",j:"i64",f:"f32",d:"f64"},i={parameters:[],results:"v"==t[0]?[]:[n[t[0]]]},r=1;r<t.length;++r)i.parameters.push(n[t[r]]);return new WebAssembly.Function(i,e)}var a=[1,0,1,96],s=t.slice(0,1),o=t.slice(1),u={i:127,j:126,f:125,d:124};for(a.push(o.length),r=0;r<o.length;++r)a.push(u[o[r]]);"v"==s?a.push(0):a=a.concat([1,u[s]]),a[1]=a.length-2;var d=new Uint8Array([0,97,115,109,1,0,0,0].concat(a,[2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0])),l=new WebAssembly.Module(d);return new WebAssembly.Instance(l,{e:{f:e}}).exports.f}(e,t);i.set(n,s)}return p.set(e,n),n}n.wasmBinary&&(v=n.wasmBinary),n.noExitRuntime&&n.noExitRuntime,"object"!=typeof WebAssembly&&_("no native wasm support detected");var b,w,S,A,L=new WebAssembly.Table({initial:881,element:"anyfunc"}),T=!1,B="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function R(e,t,n){for(var i=t+n,r=t;e[r]&&!(r>=i);)++r;if(r-t>16&&e.subarray&&B)return B.decode(e.subarray(t,r));for(var a="";t<r;){var s=e[t++];if(128&s){var o=63&e[t++];if(192!=(224&s)){var u=63&e[t++];if((s=224==(240&s)?(15&s)<<12|o<<6|u:(7&s)<<18|o<<12|u<<6|63&e[t++])<65536)a+=String.fromCharCode(s);else{var d=s-65536;a+=String.fromCharCode(55296|d>>10,56320|1023&d)}}else a+=String.fromCharCode((31&s)<<6|o)}else a+=String.fromCharCode(s)}return a}function C(e){b=e,n.HEAP8=w=new Int8Array(e),n.HEAP16=new Int16Array(e),n.HEAP32=A=new Int32Array(e),n.HEAPU8=S=new Uint8Array(e),n.HEAPU16=new Uint16Array(e),n.HEAPU32=new Uint32Array(e),n.HEAPF32=new Float32Array(e),n.HEAPF64=new Float64Array(e)}var k=n.INITIAL_MEMORY||67108864;function x(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var i=t.func;"number"==typeof i?void 0===t.arg?n.dynCall_v(i):n.dynCall_vi(i,t.arg):i(void 0===t.arg?null:t.arg)}else t(n)}}(g=n.wasmMemory?n.wasmMemory:new WebAssembly.Memory({initial:k/65536,maximum:32768}))&&(b=g.buffer),k=b.byteLength,C(b),A[45564]=5425296;var P=[],D=[],O=[],M=[],U=Math.ceil,I=Math.floor,N=0,F=null,G=null;function W(e){throw n.onAbort&&n.onAbort(e),m(e+=""),_(e),T=!0,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.",new WebAssembly.RuntimeError(e)}function V(e){return t=e,n="data:application/octet-stream;base64,",String.prototype.startsWith?t.startsWith(n):0===t.indexOf(n);var t,n}n.preloadedImages={},n.preloadedAudios={};var H,j="libffmpegST.wasm";function z(){try{if(v)return new Uint8Array(v);if(h)return h(j);throw"both async and sync fetching of the wasm failed"}catch(e){W(e)}}V(j)||(H=j,j=n.locateFile?n.locateFile(H,f):f+H),D.push({func:function(){$()}});var X={mappings:{},buffers:[null,[],[]],printChar:function(e,t){var n=X.buffers[e];0===t||10===t?((1===e?m:_)(R(n,0)),n.length=0):n.push(t)},varargs:void 0,get:function(){return X.varargs+=4,A[X.varargs-4>>2]},getStr:function(e){return function(e,t){return e?R(S,e,t):""}(e)},get64:function(e,t){return e}};function K(e){try{return g.grow(e-b.byteLength+65535>>>16),C(g.buffer),1}catch(e){}}var q={};function Y(){if(!Y.strings){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:c||"./this.program"};for(var t in q)e[t]=q[t];var n=[];for(var t in e)n.push(t+"="+e[t]);Y.strings=n}return Y.strings}!function(e,t,n,i){if(!(i>0))return 0;for(var r=n+i-1,a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s>=55296&&s<=57343&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++a)),s<=127){if(n>=r)break;t[n++]=s}else if(s<=2047){if(n+1>=r)break;t[n++]=192|s>>6,t[n++]=128|63&s}else if(s<=65535){if(n+2>=r)break;t[n++]=224|s>>12,t[n++]=128|s>>6&63,t[n++]=128|63&s}else{if(n+3>=r)break;t[n++]=240|s>>18,t[n++]=128|s>>12&63,t[n++]=128|s>>6&63,t[n++]=128|63&s}}t[n]=0}("GMT",S,182320,4);var Z={g:function(e,t,n){return X.varargs=n,0},f:function(e,t,n){X.varargs=n},e:function(e,t,n){},a:function(){W()},i:function e(){return void 0===e.start&&(e.start=Date.now()),1e3*(Date.now()-e.start)|0},k:function(e,t,n){S.copyWithin(e,t,t+n)},l:function(e){e>>>=0;var t=S.length;if(e>2147483648)return!1;for(var n,i,r=1;r<=4;r*=2){var a=t*(1+.2/r);if(a=Math.min(a,e+100663296),K(Math.min(2147483648,((n=Math.max(16777216,e,a))%(i=65536)>0&&(n+=i-n%i),n))))return!0}return!1},m:function(e,t){var n=0;return Y().forEach((function(i,r){var a=t+n;A[e+4*r>>2]=a,function(e,t,n){for(var i=0;i<e.length;++i)w[t++>>0]=e.charCodeAt(i);n||(w[t>>0]=0)}(i,a),n+=i.length+1})),0},n:function(e,t){var n=Y();A[e>>2]=n.length;var i=0;return n.forEach((function(e){i+=e.length+1})),A[t>>2]=i,0},c:function(e){return 0},d:function(e,t){var n=1==e||2==e?2:W();return w[t>>0]=n,0},j:function(e,t,n,i,r){},b:function(e,t,n,i){for(var r=0,a=0;a<n;a++){for(var s=A[t+8*a>>2],o=A[t+(8*a+4)>>2],u=0;u<o;u++)X.printChar(e,S[s+u]);r+=o}return A[i>>2]=r,0},h:function(e){var t=Date.now();return A[e>>2]=t/1e3|0,A[e+4>>2]=t%1e3*1e3|0,0},memory:g,o:function(e){return(e=+e)>=0?+I(e+.5):+U(e-.5)},table:L},Q=function(){var e={a:Z};function t(e,t){var i=e.exports;n.wasmModule=t,n.asm=i,function(e){if(N--,n.monitorRunDependencies&&n.monitorRunDependencies(N),0==N&&(null!==F&&(clearInterval(F),F=null),G)){var t=G;G=null,t()}}()}function i(e){t(e.instance,e.module)}function r(t){return(v||!u&&!d||"function"!=typeof fetch?new Promise((function(e,t){e(z())})):fetch(j,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+j+"'";return e.arrayBuffer()})).catch((function(){return z()}))).then((function(t){return WebAssembly.instantiate(t,e)})).then(t,(function(e){_("failed to asynchronously prepare wasm: "+e),W(e)}))}if(N++,n.monitorRunDependencies&&n.monitorRunDependencies(N),n.instantiateWasm)try{return n.instantiateWasm(e,t)}catch(e){return _("Module.instantiateWasm callback failed with error: "+e),!1}return function(){if(v||"function"!=typeof WebAssembly.instantiateStreaming||V(j)||"function"!=typeof fetch)return r(i);fetch(j,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(i,(function(e){r(i)}))}))}(),{}}();n.asm=Q;var J,$=n.___wasm_call_ctors=function(){return($=n.___wasm_call_ctors=n.asm.p).apply(null,arguments)};function ee(e){function t(){J||(J=!0,n.calledRun=!0,T||(x(D),x(O),r(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),function(){if(n.postRun)for("function"==typeof n.postRun&&(n.postRun=[n.postRun]);n.postRun.length;)e=n.postRun.shift(),M.unshift(e);var e;x(M)}()))}e=e||l,N>0||(function(){if(n.preRun)for("function"==typeof n.preRun&&(n.preRun=[n.preRun]);n.preRun.length;)e=n.preRun.shift(),P.unshift(e);var e;x(P)}(),N>0||(n.setStatus?(n.setStatus("Running..."),setTimeout((function(){setTimeout((function(){n.setStatus("")}),1),t()}),1)):t()))}if(n._createNewSwsCTX=function(){return(n._createNewSwsCTX=n.asm.q).apply(null,arguments)},n._free=function(){return(n._free=n.asm.r).apply(null,arguments)},n._destroyAllDecoders=function(){return(n._destroyAllDecoders=n.asm.s).apply(null,arguments)},n._createVideoDecoder=function(){return(n._createVideoDecoder=n.asm.t).apply(null,arguments)},n._sendAframe=function(){return(n._sendAframe=n.asm.u).apply(null,arguments)},n._flushDecoder=function(){return(n._flushDecoder=n.asm.v).apply(null,arguments)},n._resetDecoder=function(){return(n._resetDecoder=n.asm.w).apply(null,arguments)},n._doResize=function(){return(n._doResize=n.asm.x).apply(null,arguments)},n._init=function(){return(n._init=n.asm.y).apply(null,arguments)},n._malloc=function(){return(n._malloc=n.asm.z).apply(null,arguments)},n.dynCall_vi=function(){return(n.dynCall_vi=n.asm.A).apply(null,arguments)},n._ff_h264_cabac_tables=39594,n.asm=Q,n.addFunction=function(e,t){return E(e,t)},G=function e(){J||ee(),J||(G=e)},n.run=ee,n.preInit)for("function"==typeof n.preInit&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return ee(),n.ready};t.a=n}).call(this,n(6))},function(e,t){function n(t,i){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,i)}e.exports=n},function(e,t,n){"use strict";n.r(t);var i=n(4);
/**
 * @license
 * Copyright 2015 The Emscripten Authors
 * SPDX-License-Identifier: MIT
 */t.default=function(e){var t=0,n={};var r=function(){var e=Array.prototype.slice.call(arguments).join(" ");console.error(e)};n.instantiateWasm=function(e,t){var i=new WebAssembly.Instance(n.wasmModule,e);return n.wasmModule=null,t(i),i.exports},onmessage=function(e){try{if("load"===e.data.cmd)n.DYNAMIC_BASE=e.data.DYNAMIC_BASE,n.DYNAMICTOP_PTR=e.data.DYNAMICTOP_PTR,n.wasmModule=e.data.wasmModule,n.wasmMemory=e.data.wasmMemory,n.buffer=n.wasmMemory.buffer,n.ENVIRONMENT_IS_PTHREAD=!0,Object(i.a)("worker",n).then((function(e){n=e,postMessage({cmd:"loaded"})}));else if("objectTransfer"===e.data.cmd)n.PThread.receiveObjectTransfer(e.data);else if("run"===e.data.cmd){n.__performance_now_clock_drift=performance.now()-e.data.time,t=e.data.threadInfoStruct,n.registerPthreadPtr(t,0,0),e.data.selfThreadId,e.data.parentThreadId;var a=e.data.stackBase,s=e.data.stackBase+e.data.stackSize;n.establishStackSpace(s,a),n._emscripten_tls_init(),n.PThread.receiveObjectTransfer(e.data),n.PThread.setThreadStatus(n._pthread_self(),1);try{var o=n.dynCall_ii(e.data.start_routine,e.data.arg);n.getNoExitRuntime()||n.PThread.threadExit(o)}catch(e){if("Canceled!"===e)n.PThread.threadCancel();else if("unwind"!=e&&(Atomics.store(n.HEAPU32,t+4>>2,e instanceof n.ExitStatus?e.status:-2),Atomics.store(n.HEAPU32,t+0>>2,1),n._emscripten_futex_wake(t+0,2147483647),!(e instanceof n.ExitStatus)))throw e}}else"cancel"===e.data.cmd?t&&n.PThread.threadCancel():"setimmediate"===e.data.target||("processThreadQueue"===e.data.cmd?t&&n._emscripten_current_thread_process_queued_calls():(r("worker.js received unknown command "+e.data.cmd),r(e.data)))}catch(e){throw r("worker.js onmessage() captured an uncaught exception: "+e),e.stack&&r(e.stack),e}}}},function(e,t,n){"use strict";n.r(t);var i=n(7),r=n(0);t.default=function(e){var t="decoderSWorker",n={},a=0,s=[],o=!1,u=-1,d={frameCount:0,timeSum_ms:0,endPts:-1,startPts:-1},l=1,c=!1,h=function(t,i,r,a,o,d,l,c,h,f){var m,_=new Uint8Array(t),p=0;for(m=0;m<f;m++){var v=n.HEAPU8.subarray(i+m*r,i+m*r+h);_.set(v,p),p+=h}for(m=0;m<f/2;m++){var g=n.HEAPU8.subarray(a+m*o,a+m*o+h/2);_.set(g,p),p+=h/2}for(m=0;m<f/2;m++){var y=n.HEAPU8.subarray(d+m*l,d+m*l+h/2);_.set(y,p),p+=h/2}e.postMessage({cmd:"objectTransfer",w:h,h:f,s:c,d:_,n:u,remains:s.length},[_.buffer])},f=function(e){switch(e.type){case"create":var t=n._malloc(e.hvcc.byteLength);if(n.HEAPU8.set(e.hvcc,t),l=e.timescale,n._createVideoDecoder(0,e.timescale,t,e.hvcc.byteLength),n._free(t),c=!0,1==o)break;case"start":a||1!=c||(a=setTimeout(m,0)),o=!1;break;case"pause":o=!0;break;case"clean":s=[],n._resetDecoder();break;case"destroy":n._destroyAllDecoders(),c=!1,n=null,s=[],clearTimeout(a),a=0,o=!0,d={frameCount:0,timeSum_ms:0,endPts:-1,startPts:-1},l=1;break;case"newsws":n._createNewSwsCTX(e.w,e.h);break;case"doResize":n._doResize(e.doResize)}},m=function t(){a=0;var i=0;do{if(0==s.length){i=100;break}var r=s.shift();if(-123===r.isKey){n._flushDecoder();break}if(-321===r.isKey&&0==u){e.postMessage(Object.assign({cmd:"statistics",n:u},d)),d={frameCount:0,timeSum_ms:0,endPts:-1,startPts:-1};break}var c=0==u?performance.now():0,h=n._malloc(r.data.byteLength);n.HEAPU8.set(r.data,h),n._sendAframe(h,r.data.byteLength,1,r.dts,r.pts,r.isKey);var f=0==u?performance.now():0;0==u&&(d.timeSum_ms+=f-c,d.frameCount++,d.startPts<0&&(d.startPts=r.dts/l),d.endPts=r.dts/l)}while(0);0==o&&(a=setTimeout(t,i))};e.addEventListener("message",(function(a){var o,d=a.data;switch(d.cmd){case"init":o=d.data,r.a.ENABLE_VERBOSE=o.log,u=o.num,o.wasmModule&&(n.instantiateWasm=function(e,n){return r.a.v(t,"instantiate Wasm from cache"),WebAssembly.instantiate(o.wasmModule,e).then(n),{}}),Object(i.a)(o.currentPath,n).then((function(i){r.a.v(t,"wasm load"),(n=i).wasmLoaded=!0;var a=n.addFunction(h,"viiiiiiidii");n._init(a,!0===r.a.ENABLE_VERBOSE?1:0),e.postMessage({cmd:"init",data:n.wasmModule})}));break;case"workload":!function(e){s.push(e)}(d.data);break;case"control":f(d.data)}}))}},function(e,t,n){"use strict";n.r(t);var i=n(1),r=n.n(i),a=n(3),s=n.n(a),o={};!function(){var e=self.navigator.userAgent.toLowerCase(),t=/(edge)\/([\w.]+)/.exec(e)||/(opr)[\/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(iemobile)[\/]([\w.]+)/.exec(e)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(e)||[],n=/(ipad)/.exec(e)||/(ipod)/.exec(e)||/(windows phone)/.exec(e)||/(iphone)/.exec(e)||/(kindle)/.exec(e)||/(android)/.exec(e)||/(windows)/.exec(e)||/(mac)/.exec(e)||/(linux)/.exec(e)||/(cros)/.exec(e)||[],i={browser:t[5]||t[3]||t[1]||"",version:t[2]||t[4]||"0",majorVersion:t[4]||t[2]||"0",platform:n[0]||""},r={};if(i.browser){r[i.browser]=!0;var a=i.majorVersion.split(".");r.version={major:parseInt(i.majorVersion,10),string:i.version},a.length>1&&(r.version.minor=parseInt(a[1],10)),a.length>2&&(r.version.build=parseInt(a[2],10))}if(i.platform&&(r[i.platform]=!0),(r.chrome||r.opr||r.safari)&&(r.webkit=!0),r.rv||r.iemobile){r.rv&&delete r.rv;i.browser="msie",r.msie=!0}if(r.edge){delete r.edge;i.browser="msedge",r.msedge=!0}if(r.opr){i.browser="opera",r.opera=!0}if(r.safari&&r.android){i.browser="android",r.android=!0}for(var s in r.name=i.browser,r.platform=i.platform,o)o.hasOwnProperty(s)&&delete o[s];Object.assign(o,r)}();var u=o,d=function(){function e(e){this._message=e}return e.prototype.toString=function(){return this.name+": "+this.message},r()(e,[{key:"name",get:function(){return"RuntimeException"}},{key:"message",get:function(){return this._message}}]),e}(),l=function(e){function t(t){return e.call(this,t)||this}return s()(t,e),r()(t,[{key:"name",get:function(){return"IllegalStateException"}}]),t}(d),c=function(e){function t(t){return e.call(this,t)||this}return s()(t,e),r()(t,[{key:"name",get:function(){return"InvalidArgumentException"}}]),t}(d),h=function(e){function t(t){return e.call(this,t)||this}return s()(t,e),r()(t,[{key:"name",get:function(){return"NotImplementedException"}}]),t}(d),f=n(2),m=n.n(f),_=function(){function e(){}return e.e=function(t,n){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var i="["+t+"] > "+n;e.ENABLE_CALLBACK&&e.emitter.emit("log","error",i),e.ENABLE_ERROR&&(console.error?console.error(i):console.warn?console.warn(i):console.log(i))},e.i=function(t,n){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var i="["+t+"] > "+n;e.ENABLE_CALLBACK&&e.emitter.emit("log","info",i),e.ENABLE_INFO&&(console.info?console.info(i):console.log(i))},e.w=function(t,n){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var i="["+t+"] > "+n;e.ENABLE_CALLBACK&&e.emitter.emit("log","warn",i),e.ENABLE_WARN&&(console.warn?console.warn(i):console.log(i))},e.d=function(t,n){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var i="["+t+"] > "+n;e.ENABLE_CALLBACK&&e.emitter.emit("log","debug",i),e.ENABLE_DEBUG&&(console.debug?console.debug(i):console.log(i))},e.v=function(t,n){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var i="["+t+"] > "+n;e.ENABLE_CALLBACK&&e.emitter.emit("log","verbose",i),e.ENABLE_VERBOSE&&console.log(i)},e}();_.GLOBAL_TAG="MP4Player",_.FORCE_GLOBAL_TAG=!1,_.ENABLE_ERROR=!0,_.ENABLE_INFO=!0,_.ENABLE_WARN=!0,_.ENABLE_DEBUG=!0,_.ENABLE_VERBOSE=!0,_.ENABLE_CALLBACK=!1,_.emitter=new m.a;var p=_,v=0,g=1,y=2,E=3,b=4,w="Exception",S="HttpStatusCodeInvalid",A="EarlyEof",L=function(){function e(e){this._type=e||"undefined",this._status=v,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}var t=e.prototype;return t.destroy=function(){this._status=v,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},t.isWorking=function(){return this._status===g||this._status===y},t.open=function(e,t){throw new h("Unimplemented abstract function!")},t.abort=function(){throw new h("Unimplemented abstract function!")},r()(e,[{key:"type",get:function(){return this._type}},{key:"status",get:function(){return this._status}},{key:"needStashBuffer",get:function(){return this._needStash}},{key:"onContentLengthKnown",get:function(){return this._onContentLengthKnown},set:function(e){this._onContentLengthKnown=e}},{key:"onURLRedirect",get:function(){return this._onURLRedirect},set:function(e){this._onURLRedirect=e}},{key:"onDataArrival",get:function(){return this._onDataArrival},set:function(e){this._onDataArrival=e}},{key:"onError",get:function(){return this._onError},set:function(e){this._onError=e}},{key:"onComplete",get:function(){return this._onComplete},set:function(e){this._onComplete=e}}]),e}(),T=function(){function e(e){this._zeroStart=e||!1}var t=e.prototype;return t.getConfig=function(e,t){var n,i={};0!==t.from||-1!==t.to?(n=-1!==t.to?"bytes="+t.from.toString()+"-"+t.to.toString():"bytes="+t.from.toString()+"-",i.Range=n):this._zeroStart&&(i.Range="bytes=0-");return{url:e,headers:i}},t.removeURLParameters=function(e){return e},e}(),B=function(e){function t(t){var n;return(n=e.call(this,"fetch-stream-loader")||this).TAG="FetchStreamLoader",n._seekHandler=new T,n._config=t,n._needStash=!0,n._requestAbort=!1,n._contentLength=null,n._receivedLength=0,n._resumeFrom=0,n}s()(t,e),t.isSupported=function(){try{var e=u.msedge&&u.version.minor>=15048,t=!u.msedge||e;return self.fetch&&self.ReadableStream&&t}catch(e){return!1}};var n=t.prototype;return n.destroy=function(){this.isWorking()&&this.abort(),e.prototype.destroy.call(this)},n.pause=function(){this.isWorking()&&(this.abort(),this._resumeFrom=this._range.from+this._receivedLength,this._receivedLength=0,p.v(this.TAG,"pause at "+this._resumeFrom+" bytes"))},n.resume=function(){this.isWorking()||(this.open(this._dataSource,{from:this._resumeFrom,to:-1}),this._resumeFrom=0)},n.open=function(e,t){var n=this;this._dataSource=e,this._range=t;var i=e.url;this._config.reuseRedirectedURL&&null!=e.redirectedURL&&(i=e.redirectedURL);var r=this._seekHandler.getConfig(i,t),a=new self.Headers;if("object"==typeof r.headers){var s=r.headers;for(var o in s)a.append(o,s[o])}var u={method:"GET",headers:a,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if("object"==typeof this._config.headers)for(var l in this._config.headers)a.append(l,this._config.headers[l]);!1===e.cors&&(u.mode="same-origin"),e.withCredentials&&(u.credentials="include"),e.referrerPolicy&&(u.referrerPolicy=e.referrerPolicy),this._status=g,self.fetch(r.url,u).then((function(e){if(n._requestAbort)return n._requestAbort=!1,void(n._status=v);if(e.ok&&e.status>=200&&e.status<=299){if(e.url!==r.url&&n._onURLRedirect){var t=n._seekHandler.removeURLParameters(e.url);n._onURLRedirect(t)}var i=e.headers.get("Content-Length");return null!=i&&(n._contentLength=parseInt(i),0!==n._contentLength&&n._onContentLengthKnown&&n._onContentLengthKnown(n._contentLength)),n._pump.call(n,e.body.getReader())}if(n._status=E,!n._onError)throw new d("FetchStreamLoader: Http code invalid, "+e.status+" "+e.statusText);n._onError(S,{code:e.status,msg:e.statusText})})).catch((function(e){if(n._status=E,!n._onError)throw e;n._onError(w,{code:-1,msg:e.message})}))},n.abort=function(){this._requestAbort=!0},n._pump=function(e){var t=this;return e.read().then((function(n){if(n.done)if(null!==t._contentLength&&t._receivedLength<t._contentLength){t._status=E;var i=A,r={code:-1,msg:"Fetch stream meet Early-EOF"};if(!t._onError)throw new d(r.msg);t._onError(i,r)}else t._status=b,t._onComplete&&t._onComplete(t._range.from,t._range.from+t._receivedLength-1);else{if(!0===t._requestAbort)return t._requestAbort=!1,t._status=b,e.cancel();t._status=y;var a=n.value.buffer,s=t._range.from+t._receivedLength;t._receivedLength+=a.byteLength,t._onDataArrival&&t._onDataArrival(a,s,t._receivedLength),t._pump(e)}})).catch((function(e){if(11!==e.code||!u.msedge){t._status=E;var n=0,i=null;if(19!==e.code&&"network error"!==e.message||!(null===t._contentLength||null!==t._contentLength&&t._receivedLength<t._contentLength)?(n=w,i={code:e.code,msg:e.message}):(n=A,i={code:e.code,msg:"Fetch stream meet Early-EOF"}),!t._onError)throw new d(i.msg);t._onError(n,i)}}))},t}(L),R=function(){function e(e){this.TAG="ExpGolomb",this._buffer=e,this._buffer_index=0,this._total_bytes=e.byteLength,this._total_bits=8*e.byteLength,this._current_word=0,this._current_word_bits_left=0}var t=e.prototype;return t.destroy=function(){this._buffer=null},t._fillCurrentWord=function(){var e=this._total_bytes-this._buffer_index;if(e<=0)throw new l("ExpGolomb: _fillCurrentWord() but no bytes available");var t=Math.min(4,e),n=new Uint8Array(4);n.set(this._buffer.subarray(this._buffer_index,this._buffer_index+t)),this._current_word=new DataView(n.buffer).getUint32(0,!1),this._buffer_index+=t,this._current_word_bits_left=8*t},t.readBits=function(e){if(e>32)throw new c("ExpGolomb: readBits() bits exceeded max 32bits!");if(e<=this._current_word_bits_left){var t=this._current_word>>>32-e;return this._current_word<<=e,this._current_word_bits_left-=e,t}var n=this._current_word_bits_left?this._current_word:0;n>>>=32-this._current_word_bits_left;var i=e-this._current_word_bits_left;this._fillCurrentWord();var r=Math.min(i,this._current_word_bits_left),a=this._current_word>>>32-r;return this._current_word<<=r,this._current_word_bits_left-=r,n=n<<r|a},t.readBool=function(){return 1===this.readBits(1)},t.readByte=function(){return this.readBits(8)},t._skipLeadingZero=function(){var e;for(e=0;e<this._current_word_bits_left;e++)if(0!=(this._current_word&2147483648>>>e))return this._current_word<<=e,this._current_word_bits_left-=e,e;return this._fillCurrentWord(),e+this._skipLeadingZero()},t.readUEG=function(){var e=this._skipLeadingZero();return this.readBits(e+1)-1},t.readSEG=function(){var e=this.readUEG();return 1&e?e+1>>>1:-1*(e>>>1)},e}(),C=function(){function e(){}return e._ebsp2rbsp=function(e){for(var t=e,n=t.byteLength,i=new Uint8Array(n),r=0,a=0;a<n;a++)a>=2&&3===t[a]&&0===t[a-1]&&0===t[a-2]||(i[r]=t[a],r++);return new Uint8Array(i.buffer,0,r)},e.parseH265SPS=function(t){var n=e._ebsp2rbsp(t),i=new R(n);i.readBits(16),i.readBits(4);var r=i.readBits(3);if(r>6)console.log("sps_max_sub_layers_minus1 is too big");else{i.readBits(1);var a="hev1.";a+=["","A","B","C"][i.readBits(2)];var s=i.readBits(1),o=i.readBits(5);a+=o+".";for(var u=e.getProfileString(o),d=0,l=0;l<32;l++)d|=i.readBits(1)<<l;a+=d.toString(16).toUpperCase()+".",a+=0===s?"L":"H";var c=[];c.push(i.readByte()),c.push(i.readByte()),c.push(i.readByte()),c.push(i.readByte()),c.push(i.readByte()),c.push(i.readByte());for(var h=5,f=5;f>=0;f--)if(0!==c[f]){h=f;break}var m=i.readByte();a+=m+".";for(var _=0;_<h;_++)a+=c[_].toString(16).toUpperCase()+".";a=a.substr(0,a.length-1);for(var p=e.getLevelString(m),v=[],g=[],y=0;y<r;y++)v[y]=i.readBool(),g[y]=i.readBool();if(r>0)for(var E=r;E<8;E++)i.readBits(2);for(var b=0;b<r;b++)v[b]&&(i.readByte(),i.readBits(32),i.readBits(4),i.readBits(32),i.readBits(12),i.readBits(1)),g[b]&&i.readByte();if(!(i.readUEG()>16)){var w=i.readUEG(),S=!1;3===w&&(S=i.readBool());var A=[0,420,422,444][w],L=i.readUEG(),T=i.readUEG();if(i.readBool()){var B=i.readUEG(),C=i.readUEG(),k=i.readUEG(),x=1!=w&&2!=w||0!=S?1:2,P=1==w&&0==S?2:1;L-=x*C+x*B,T-=P*i.readUEG()+P*k}var D=i.readUEG()+8;i.readUEG();for(var O=i.readUEG(),M=i.readBool()?0:r;M<=r;M++)i.readUEG(),i.readUEG(),i.readUEG();if(i.readUEG(),i.readUEG(),i.readUEG(),i.readUEG(),i.readUEG(),i.readUEG(),i.readBool()&&i.readBool())for(var U=0;U<4;U++)for(var I=0;I<6;I+=3===U?3:1)if(i.readBool()){var N=1<<4+(U<<1)>64?64:1<<4+(U<<1);U>1&&i.readSEG();for(var F=0;F<N;F++)i.readSEG()}else i.readUEG();i.readBits(2),i.readBool()&&(i.readByte(),i.readUEG(),i.readUEG(),i.readBits(1));var G,W,V,H,j,z=i.readUEG();if(z>0)for(var X=[],K=0;K<z;K++){var q=!1;if(0!==K&&(q=i.readBool()),q){var Y=0;K===z&&(Y=i.readUEG()),i.readBits(1),i.readUEG();for(var Z=0;Z<=X[K-(Y+1)];Z++)i.readBool()||i.readBits(1)}else{var Q=i.readUEG(),J=i.readUEG();if(Q>16||J>16)return void console.log("error in num_negative_positive_pics");X[K]=Q+J;for(var $=0;$<Q;$++)i.readUEG(),i.readBits(1);for(var ee=0;ee<J;ee++)i.readUEG(),i.readBits(1)}}if(i.readBool())for(var te=i.readUEG(),ne=0;ne<te;ne++)i.readBits(O+4),i.readBool();if(i.readBits(2),i.readBool()&&(i.readBool()&&255===i.readByte()&&(W=i.readByte()<<8|i.readByte(),G=i.readByte()<<8|i.readByte()),i.readBool()&&i.readBits(1),i.readBool()&&(i.readBits(4),i.readBool()&&i.readBits(24)),i.readBool()&&(i.readUEG(),i.readUEG()),i.readBits(3),i.readBool()&&(i.readUEG(),i.readUEG(),i.readUEG(),i.readUEG()),i.readBool())){var ie=i.readBits(32);j=(V=i.readBits(32))/(H=ie)}return i.destroy(),i=null,{profile_string:u,level_string:p,bit_depth:D,chroma_format:A,chroma_format_string:e.getChromaFormatString(A),codecs:a,frame_rate:{fixed:!0,fps:j,fps_den:H,fps_num:V},sar_ratio:{width:W,height:G},codec_size:{width:L,height:T},present_size:{width:L,height:T}}}console.log("sps_id is too big")}},e.parseSPS=function(t){var n=e._ebsp2rbsp(t),i=new R(n);i.readByte();var r=i.readByte();i.readByte();var a=i.readByte();i.readUEG();var s=e.getProfileString(r),o=e.getLevelString(a),u=1,d=420,l=8;if((100===r||110===r||122===r||244===r||44===r||83===r||86===r||118===r||128===r||138===r||144===r)&&(3===(u=i.readUEG())&&i.readBits(1),u<=3&&(d=[0,420,422,444][u]),l=i.readUEG()+8,i.readUEG(),i.readBits(1),i.readBool()))for(var c=3!==u?8:12,h=0;h<c;h++)i.readBool()&&(h<6?e._skipScalingList(i,16):e._skipScalingList(i,64));i.readUEG();var f=i.readUEG();if(0===f)i.readUEG();else if(1===f){i.readBits(1),i.readSEG(),i.readSEG();for(var m=i.readUEG(),_=0;_<m;_++)i.readSEG()}var p=i.readUEG();i.readBits(1);var v=i.readUEG(),g=i.readUEG(),y=i.readBits(1);0===y&&i.readBits(1),i.readBits(1);var E=0,b=0,w=0,S=0;i.readBool()&&(E=i.readUEG(),b=i.readUEG(),w=i.readUEG(),S=i.readUEG());var A=1,L=1,T=0,B=!0,C=0,k=0;if(i.readBool()){if(i.readBool()){var x=i.readByte();x>0&&x<16?(A=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][x-1],L=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][x-1]):255===x&&(A=i.readByte()<<8|i.readByte(),L=i.readByte()<<8|i.readByte())}if(i.readBool()&&i.readBool(),i.readBool()&&(i.readBits(4),i.readBool()&&i.readBits(24)),i.readBool()&&(i.readUEG(),i.readUEG()),i.readBool()){var P=i.readBits(32),D=i.readBits(32);B=i.readBool(),T=(C=D)/(k=2*P)}}var O=1;1===A&&1===L||(O=A/L);var M=0,U=0;0===u?(M=1,U=2-y):(M=3===u?1:2,U=(1===u?2:1)*(2-y));var I=16*(v+1),N=16*(g+1)*(2-y);I-=(E+b)*M,N-=(w+S)*U;var F=Math.ceil(I*O);return i.destroy(),i=null,{profile_string:s,level_string:o,bit_depth:l,ref_frames:p,chroma_format:d,chroma_format_string:e.getChromaFormatString(d),frame_rate:{fixed:B,fps:T,fps_den:k,fps_num:C},sar_ratio:{width:A,height:L},codec_size:{width:I,height:N},present_size:{width:F,height:N}}},e._skipScalingList=function(e,t){for(var n=8,i=8,r=0;r<t;r++)0!==i&&(i=(n+e.readSEG()+256)%256),n=0===i?n:i},e.getProfileString=function(e){switch(e){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},e.getLevelString=function(e){return(e/10).toFixed(1)},e.getChromaFormatString=function(e){switch(e){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},e}(),k=function(){function e(){}return e.getSilentFrame=function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},e}(),x=function(){function e(){}return e.init=function(){for(var t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[],hev1:[],hvcC:[],fLaC:[],dfLa:[],alaw:[],chan:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var n=e.constants={};n.HEVCFTYP=new Uint8Array([105,115,111,109,0,0,2,0,105,115,111,109,105,115,111,50,109,112,52,49,32,32,32,8]),n.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),n.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),n.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),n.STSC=n.STCO=n.STTS,n.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),n.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),n.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),n.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),n.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},e.box=function(e){for(var t=8,n=null,i=Array.prototype.slice.call(arguments,1),r=i.length,a=0;a<r;a++)t+=i[a].byteLength;(n=new Uint8Array(t))[0]=t>>>24&255,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n.set(e,4);for(var s=8,o=0;o<r;o++)n.set(i[o],s),s+=i[o].byteLength;return n},e.generateInitSegment=function(t){var n;n=-1!==t.codec.search("avc1")?e.box(e.types.ftyp,e.constants.FTYP):e.box(e.types.ftyp,e.constants.HEVCFTYP);var i=e.moov(t),r=new Uint8Array(n.byteLength+i.byteLength);return r.set(n,0),r.set(i,n.byteLength),r},e.moov=function(t){var n=e.mvhd(t.timescale,t.duration),i=e.trak(t),r=e.mvex(t);return e.box(e.types.moov,n,i,r)},e.mvhd=function(t,n){return e.box(e.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t,n>>>24&255,n>>>16&255,n>>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},e.trak=function(t){return e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.tkhd=function(t){var n=t.id,i=t.duration,r=t.presentWidth,a=t.presentHeight;return e.box(e.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,255&n,0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,255&i,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>>8&255,255&r,0,0,a>>>8&255,255&a,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t),e.hdlr(t),e.minf(t))},e.mdhd=function(t){var n=t.timescale,i=t.duration;return e.box(e.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,255&n,i>>>24&255,i>>>16&255,i>>>8&255,255&i,85,196,0,0]))},e.hdlr=function(t){var n=null;return n="audio"===t.type?e.constants.HDLR_AUDIO:e.constants.HDLR_VIDEO,e.box(e.types.hdlr,n)},e.minf=function(t){var n=null;return n="audio"===t.type?e.box(e.types.smhd,e.constants.SMHD):e.box(e.types.vmhd,e.constants.VMHD),e.box(e.types.minf,n,e.dinf(),e.stbl(t))},e.dinf=function(){return e.box(e.types.dinf,e.box(e.types.dref,e.constants.DREF))},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.constants.STTS),e.box(e.types.stsc,e.constants.STSC),e.box(e.types.stsz,e.constants.STSZ),e.box(e.types.stco,e.constants.STCO))},e.stsd=function(t){return"mp3"===t.codec?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.mp3(t)):"flac"===t.codec?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.fLaC(t)):"alaw"===t.codec?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.alaw(t)):-1!==t.codec.search("mp4a")?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.mp4a(t)):-1!==t.codec.search("avc1")?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.avc1(t)):e.box(e.types.stsd,e.constants.STSD_PREFIX,e.hev1(t))},e.fLaC=function(t){var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,16,0,0,0,0,31,64,0,0]);return e.box(e.types.fLaC,n,e.dfLa(t))},e.dfLa=function(t){var n=new Uint8Array([0,0,0,0,128,0,0,34,1,64,16,0,0,1,64,62,128,0,1,244,0,240,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);return e.box(e.types.dfLa,n)},e.mp3=function(t){var n=t.channelCount,i=t.audioSampleRate,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,n,0,16,0,0,0,0,i>>>8&255,255&i,0,0]);return e.box(e.types[".mp3"],r)},e.alaw=function(t){var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,8,0,0,0,0,31,64,0,0]);return e.box(e.types.alaw,n,e.chan(t))},e.chan=function(t){var n=new Uint8Array([0,0,0,0,0,1,0,0,0,0,0,4,0,0,0,0]);return e.box(e.types.chan,n)},e.mp4a=function(t){if(t.mp4a){var n=new Uint8Array(t.mp4a.byteLength);return n.set(t.mp4a,0),n}var i=t.channelCount,r=t.audioSampleRate,a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i,0,16,0,0,0,0,r>>>8&255,255&r,0,0]);return e.box(e.types.mp4a,a,e.esds(t))},e.esds=function(t){var n=t.config||[],i=n.length,r=new Uint8Array([0,0,0,0,3,23+i,0,1,0,4,15+i,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([i]).concat(n).concat([6,1,2]));return e.box(e.types.esds,r)},e.avc1=function(t){var n=t.avcc,i=t.codecWidth,r=t.codecHeight,a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,i>>>8&255,255&i,r>>>8&255,255&r,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return e.box(e.types.avc1,a,e.box(e.types.avcC,n))},e.hev1=function(t){var n=t.avcc,i=t.codecWidth,r=t.codecHeight,a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,i>>>8&255,255&i,r>>>8&255,255&r,0,72,0,0,0,72,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return e.box(e.types.hev1,a,e.box(e.types.hvcC,n))},e.mvex=function(t){return e.box(e.types.mvex,e.trex(t))},e.trex=function(t){var n=t.id,i=new Uint8Array([0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,255&n,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return e.box(e.types.trex,i)},e.moof=function(t,n){return e.box(e.types.moof,e.mfhd(t.sequenceNumber),e.traf(t,n))},e.mfhd=function(t){var n=new Uint8Array([0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t]);return e.box(e.types.mfhd,n)},e.traf=function(t,n){var i=t.id,r=e.box(e.types.tfhd,new Uint8Array([0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,255&i])),a=e.box(e.types.tfdt,new Uint8Array([0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,255&n])),s=e.sdtp(t),o=e.trun(t,s.byteLength+16+16+8+16+8+8);return e.box(e.types.traf,r,a,o,s)},e.sdtp=function(t){for(var n=t.samples||[],i=n.length,r=new Uint8Array(4+i),a=0;a<i;a++){var s=n[a].flags;r[a+4]=s.isLeading<<6|s.dependsOn<<4|s.isDependedOn<<2|s.hasRedundancy}return e.box(e.types.sdtp,r)},e.trun=function(t,n){var i=t.samples||[],r=i.length,a=12+16*r,s=new Uint8Array(a);n+=8+a,s.set([0,0,15,1,r>>>24&255,r>>>16&255,r>>>8&255,255&r,n>>>24&255,n>>>16&255,n>>>8&255,255&n],0);for(var o=0;o<r;o++){var u=i[o].duration,d=i[o].size,l=i[o].flags,c=i[o].cts;s.set([u>>>24&255,u>>>16&255,u>>>8&255,255&u,d>>>24&255,d>>>16&255,d>>>8&255,255&d,l.isLeading<<2|l.dependsOn,l.isDependedOn<<6|l.hasRedundancy<<4|l.isNonSync,0,0,c>>>24&255,c>>>16&255,c>>>8&255,255&c],12+16*o)}return e.box(e.types.trun,s)},e.mdat=function(t){return e.box(e.types.mdat,t)},e}();x.init();var P=x,D=function(e,t,n,i,r){this.dts=e,this.pts=t,this.duration=n,this.originalDts=i,this.isSyncPoint=r,this.fileposition=null},O=function(){function e(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return e.prototype.appendSyncPoint=function(e){e.isSyncPoint=!0,this.syncPoints.push(e)},e}(),M=function(){function e(){this._list=[]}var t=e.prototype;return t.clear=function(){this._list=[]},t.appendArray=function(e){var t=this._list;0!==e.length&&(t.length>0&&e[0].originalDts<t[t.length-1].originalDts&&this.clear(),Array.prototype.push.apply(t,e))},t.getLastSyncPointBeforeDts=function(e){if(0==this._list.length)return null;var t=this._list,n=0,i=t.length-1,r=0,a=0,s=i;for(e<t[0].dts&&(n=0,a=s+1);a<=s;){if((r=a+Math.floor((s-a)/2))===i||e>=t[r].dts&&e<t[r+1].dts){n=r;break}t[r].dts<e?a=r+1:s=r-1}return this._list[n]},e}(),U=function(){function e(e){this._type=e,this._list=[],this._lastAppendLocation=-1}var t=e.prototype;return t.isEmpty=function(){return 0===this._list.length},t.clear=function(){this._list=[],this._lastAppendLocation=-1},t._searchNearestSegmentBefore=function(e){var t=this._list;if(0===t.length)return-2;var n=t.length-1,i=0,r=0,a=n,s=0;if(e<t[0].originalBeginDts)return s=-1;for(;r<=a;){if((i=r+Math.floor((a-r)/2))===n||e>t[i].lastSample.originalDts&&e<t[i+1].originalBeginDts){s=i;break}t[i].originalBeginDts<e?r=i+1:a=i-1}return s},t._searchNearestSegmentAfter=function(e){return this._searchNearestSegmentBefore(e)+1},t.append=function(e){var t=this._list,n=e,i=this._lastAppendLocation,r=0;-1!==i&&i<t.length&&n.originalBeginDts>=t[i].lastSample.originalDts&&(i===t.length-1||i<t.length-1&&n.originalBeginDts<t[i+1].originalBeginDts)?r=i+1:t.length>0&&(r=this._searchNearestSegmentBefore(n.originalBeginDts)+1),this._lastAppendLocation=r,this._list.splice(r,0,n)},t.getLastSegmentBefore=function(e){var t=this._searchNearestSegmentBefore(e);return t>=0?this._list[t]:null},t.getLastSampleBefore=function(e){var t=this.getLastSegmentBefore(e);return null!=t?t.lastSample:null},t.getLastSyncPointBefore=function(e){for(var t=this._searchNearestSegmentBefore(e),n=this._list[t].syncPoints;0===n.length&&t>0;)t--,n=this._list[t].syncPoints;return n.length>0?n[n.length-1]:null},r()(e,[{key:"type",get:function(){return this._type}},{key:"length",get:function(){return this._list.length}}]),e}(),I=function(){function e(e,t){this.TAG="MP4Remuxer",this._config=e,this._isLive=!1,this._dtsBase=0,this._dtsBaseInited=!0,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new U("audio"),this._videoSegmentInfoList=new U("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!(!u.chrome||!(u.version.major<50||50===u.version.major&&u.version.build<2661)),this._fillSilentAfterSeek=u.msedge||u.msie,this._mp3UseMpegAudio=!u.firefox,this._fillAudioTimestampGap=!1,this._flvPlayer=t}var t=e.prototype;return t.destroy=function(){this._dtsBase=0,this._dtsBaseInited=!0,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null,this._flvPlayer=null},t.bindDataSource=function(e){return e.onDataAvailable=this.remux.bind(this),e.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},t.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},t.seek=function(e){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},t.remux=function(e,t){if(!this._onMediaSegment)throw new l("MP4Remuxer: onMediaSegment callback must be specificed!");this._remuxVideo(t,!0),this._remuxAudio(e,!0),arguments[2]&&this._remuxSilent(arguments[2],!0)},t._onTrackMetadataReceived=function(e,t){var n=null,i="mp4",r=t.codec;if("audio"===e)t.type="audio",this._audioMeta=t,"mp3"===t.codec&&this._mp3UseMpegAudio?(i="mpeg",r="",n=new Uint8Array):n=P.generateInitSegment(t);else if("video"===e)this._videoMeta=t,n=P.generateInitSegment(t);else{if("silent"!==e)return;this._videoMeta=t,"mp3"===t.codec&&this._mp3UseMpegAudio?(i="mpeg",r="",n=new Uint8Array):n=P.generateInitSegment(t)}if(!this._onInitSegment)throw new l("MP4Remuxer: onInitSegment callback must be specified!");p.i(this.TAG,"generated "+e+" InitSegment");var a="video"===e?"video":"audio";this._onInitSegment(e,{type:a,data:n.buffer,codec:r,container:a+"/"+i,mediaDuration:t.duration})},t._calculateDtsBase=function(e,t){return this._dtsBaseInited=!0,this._dtsBase=0,!0},t.flushStashedSamples=function(){var e=this._videoStashedLastSample,t=this._audioStashedLastSample,n={type:"video",id:1,sequenceNumber:0,samples:[],length:0};null!=e&&(n.samples.push(e),n.length=e.length);var i={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};null!=t&&(i.samples.push(t),i.length=t.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this.usingSilentTrack?this._remuxSilent(n,!0):this._remuxVideo(n,!0),this._remuxAudio(i,!0)},t._remuxAudio=function(e,t){if(null!=this._audioMeta){e.discontinuity&&(this._audioStashedLastSample=null,this._audioSegmentInfoList.clear(),this._audioNextDts=void 0,delete e.discontinuity);var n,i=e,r=i.samples,a=void 0,s=-1,o=this._audioMeta.refSampleDuration,d="mp3"===this._audioMeta.codec&&this._mp3UseMpegAudio,l=this._dtsBaseInited&&void 0===this._audioNextDts,c=!1;if(r&&0!==r.length&&(1!==r.length||t)){var h=0,f=null,m=0;d?(h=0,m=i.length):(h=8,m=8+i.length);var _=null;if(r.length>1&&(m-=(_=r.pop()).length),null!=this._audioStashedLastSample){var v=this._audioStashedLastSample;this._audioStashedLastSample=null,r.unshift(v),m+=v.length}null!=_&&(this._audioStashedLastSample=_);var g=r[0].dts-this._dtsBase;if(this._audioNextDts)a=g-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())a=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&"mp3"!==this._audioMeta.originalCodec&&(c=!0);else{var y=this._audioSegmentInfoList.getLastSampleBefore(g);if(null!=y){var E=g-(y.originalDts+y.duration);E<=3&&(E=0),a=g-(y.dts+y.duration+E)}else a=0}if(c){var b=g-a,w=this._videoSegmentInfoList.getLastSegmentBefore(g);if(null!=w&&w.beginDts<b){var S=k.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);if(S){var A=w.beginDts,L=b-w.beginDts;p.v(this.TAG,"InsertPrefixSilentAudio: dts: "+A+", duration: "+L),r.unshift({unit:S,dts:A,pts:A}),m+=S.byteLength}}else c=!1}for(var T=[],B=0;B<r.length;B++){var R=r[B],C=R.unit,x=R.dts-this._dtsBase,M=x-a;-1===s&&(s=M);var U=0;if(B!==r.length-1)U=r[B+1].dts-this._dtsBase-a-M;else if(null!=_)U=_.dts-this._dtsBase-a-M;else U=T.length>=1?T[T.length-1].duration:Math.floor(o);var I=!1,N=null;if(U>1.5*o&&"mp3"!==this._audioMeta.codec&&"flac"!==this._audioMeta.codec&&"alaw"!==this._audioMeta.codec&&this._fillAudioTimestampGap&&!u.safari){I=!0;var F=Math.abs(U-o),G=Math.ceil(F/o),W=M+o;p.w(this.TAG,"Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.\ndts: "+(M+U)+" ms, expected: "+(M+Math.round(o))+" ms, delta: "+Math.round(F)+" ms, generate: "+G+" frames");var V=k.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);null==V&&(p.w(this.TAG,"Unable to generate silent frame for "+this._audioMeta.originalCodec+" with "+this._audioMeta.channelCount+" channels, repeat last frame"),V=C),N=[];for(var H=0;H<G;H++){var j=Math.round(W);if(N.length>0){var z=N[N.length-1];z.duration=j-z.dts}var X={dts:j,pts:j,cts:0,unit:V,size:V.byteLength,duration:0,originalDts:x,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};N.push(X),m+=X.size,W+=o}var K=N[N.length-1];K.duration=M+U-K.dts,U=Math.round(o)}T.push({dts:M,pts:M,cts:0,unit:R.unit,size:R.unit.byteLength,duration:U,originalDts:x,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),I&&T.push.apply(T,N)}d?f=new Uint8Array(m):((f=new Uint8Array(m))[0]=m>>>24&255,f[1]=m>>>16&255,f[2]=m>>>8&255,f[3]=255&m,f.set(P.types.mdat,4));for(var q=0;q<T.length;q++){var Y=T[q].unit;f.set(Y,h),h+=Y.byteLength}var Z=T[T.length-1];n=Z.dts+Z.duration,this._audioNextDts=n;var Q=new O;Q.beginDts=s,Q.endDts=n,Q.beginPts=s,Q.endPts=n,Q.originalBeginDts=T[0].originalDts,Q.originalEndDts=Z.originalDts+Z.duration,Q.firstSample=new D(T[0].dts,T[0].pts,T[0].duration,T[0].originalDts,!1),Q.lastSample=new D(Z.dts,Z.pts,Z.duration,Z.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(Q),i.samples=T,i.sequenceNumber++;var J=null;J=d?new Uint8Array:P.moof(i,s),i.samples=[],i.length=0;var $={type:"audio",data:this._mergeBoxes(J,f).buffer,sampleCount:T.length,info:Q};d&&l&&($.timestampOffset=s),this._onMediaSegment("audio",$)}}},t._remuxVideo=function(e,t){if(e.samples&&0!==e.samples.length){if(!0===e.isH265){for(var n=0;n<e.samples.length;n++)e.samples[n].dts-=this._dtsBase,e.samples[n].pts-=this._dtsBase;return this._flvPlayer._wasmPlayer.feedChunk(e),e.samples=[],e.length=0,void e.sequenceNumber++}if((1!==e.samples.length||t)&&null!=this._videoMeta){e.discontinuity&&(this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._videoNextDts=void 0,delete e.discontinuity);var i,r,a=e,s=a.samples,o=void 0,u=-1,d=-1,l=8,c=null,h=8+e.length,f=null;if(s.length>1&&(h-=(f=s.pop()).length),null!=this._videoStashedLastSample){var m=this._videoStashedLastSample;this._videoStashedLastSample=null,s.unshift(m),h+=m.length}null!=f&&(this._videoStashedLastSample=f);var _=s[0].dts-this._dtsBase;if(this._videoNextDts)o=_-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())o=0;else{var p=this._videoSegmentInfoList.getLastSampleBefore(_);if(null!=p){var v=_-(p.originalDts+p.duration);v<=3&&(v=0),o=_-(p.dts+p.duration+v)}else o=0}for(var g=new O,y=[],E=0;E<s.length;E++){var b=s[E],w=b.dts-this._dtsBase,S=b.isKeyframe,A=w-o,L=b.cts,T=A+L;-1===u&&(u=A,d=T);var B=0;if(E!==s.length-1)B=s[E+1].dts-this._dtsBase-o-A;else if(null!=f)B=f.dts-this._dtsBase-o-A;else B=y.length>=1?y[y.length-1].duration:Math.floor(this._videoMeta.refSampleDuration);if(S){var R=new D(A,T,B,b.dts,!0);R.fileposition=b.fileposition,g.appendSyncPoint(R)}y.push({dts:A,pts:T,cts:L,units:b.units,size:b.length,isKeyframe:S,duration:B,originalDts:w,flags:{isLeading:0,dependsOn:S?2:1,isDependedOn:S?1:0,hasRedundancy:0,isNonSync:S?0:1}})}(c=new Uint8Array(h))[0]=h>>>24&255,c[1]=h>>>16&255,c[2]=h>>>8&255,c[3]=255&h,c.set(P.types.mdat,4);for(var C=0;C<y.length;C++)for(var k=y[C].units;k.length;){var x=k.shift().data;c.set(x,l),l+=x.byteLength}var M=y[y.length-1];if(i=M.dts+M.duration,r=M.pts+M.duration,this._videoNextDts=i,g.beginDts=u,g.endDts=i,g.beginPts=d,g.endPts=r,g.originalBeginDts=y[0].originalDts,g.originalEndDts=M.originalDts+M.duration,g.firstSample=new D(y[0].dts,y[0].pts,y[0].duration,y[0].originalDts,y[0].isKeyframe),g.lastSample=new D(M.dts,M.pts,M.duration,M.originalDts,M.isKeyframe),this._isLive||this._videoSegmentInfoList.append(g),a.samples=y,a.sequenceNumber++,this._forceFirstIDR){var U=y[0].flags;U.dependsOn=2,U.isNonSync=0}var I=P.moof(a,u);a.samples=[],a.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(I,c).buffer,sampleCount:y.length,info:g})}}},t._remuxSilent=function(e,t){if(this.usingSilentTrack=!0,e.samples&&0!==e.samples.length&&null!=this._videoMeta&&(1!==e.samples.length||t)){for(;e.samples.length>0&&e.samples[0].dts-this._dtsBase<0;)e.samples.shift();if(e.samples&&0!==e.samples.length){e.discontinuity&&(this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._videoNextDts=void 0,delete e.discontinuity);var n,i=e,r=i.samples,a=void 0,s=-1,o=this._videoMeta.refSampleDuration,u="mp3"===this._videoMeta.codec&&this._mp3UseMpegAudio,d=this._dtsBaseInited&&void 0===this._videoNextDts;if(1!==r.length||t){var l=0,c=null,h=0;u?(l=0,h=i.length):(l=8,h=8+i.length);var f=null;if(r.length>1&&(h-=(f=r.pop()).length),null!=this._videoStashedLastSample){var m=this._videoStashedLastSample;this._videoStashedLastSample=null,r.unshift(m),h+=m.length}null!=f&&(this._videoStashedLastSample=f);var _=r[0].dts-this._dtsBase;if(this._videoNextDts)a=_-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())a=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&"mp3"!==this._videoMeta.originalCodec&&!0;else{var p=this._videoSegmentInfoList.getLastSampleBefore(_);if(null!=p){var v=_-(p.originalDts+p.duration);v<=3&&(v=0),a=_-(p.dts+p.duration+v)}else a=0}for(var g=[],y=0;y<r.length;y++){var E=r[y],b=(E.unit,E.dts-this._dtsBase),w=b-a;-1===s&&(s=w);var S=0;if(y!==r.length-1)S=r[y+1].dts-this._dtsBase-a-w;else if(null!=f)S=f.dts-this._dtsBase-a-w;else S=g.length>=1?g[g.length-1].duration:Math.floor(o);g.push({dts:w,pts:w,cts:0,unit:E.unit,size:E.unit.byteLength,duration:S,originalDts:b,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}})}u?c=new Uint8Array(h):((c=new Uint8Array(h))[0]=h>>>24&255,c[1]=h>>>16&255,c[2]=h>>>8&255,c[3]=255&h,c.set(P.types.mdat,4));for(var A=0;A<g.length;A++){var L=g[A].unit;c.set(L,l),l+=L.byteLength}var T=g[g.length-1];n=T.dts+T.duration,this._videoNextDts=n;var B=new O;B.beginDts=s,B.endDts=n,B.beginPts=s,B.endPts=n,B.originalBeginDts=g[0].originalDts,B.originalEndDts=T.originalDts+T.duration,B.firstSample=new D(g[0].dts,g[0].pts,g[0].duration,g[0].originalDts,!1),B.lastSample=new D(T.dts,T.pts,T.duration,T.originalDts,!1),this._isLive||this._videoSegmentInfoList.append(B),i.samples=g,i.sequenceNumber++;var R=null;R=u?new Uint8Array:P.moof(i,s),i.samples=[],i.length=0;var C={type:"audio",data:this._mergeBoxes(R,c).buffer,sampleCount:g.length,info:B};u&&d&&(C.timestampOffset=s),this._onMediaSegment("silent",C)}}}},t._mergeBoxes=function(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(e,0),n.set(t,e.byteLength),n},r()(e,[{key:"onInitSegment",get:function(){return this._onInitSegment},set:function(e){this._onInitSegment=e}},{key:"onMediaSegment",get:function(){return this._onMediaSegment},set:function(e){this._onMediaSegment=e}}]),e}(),N=MediaSource.isTypeSupported("video/mp4;codecs=hev1.1.6.L90"),F=(MediaSource.isTypeSupported("video/mp4;codecs=alaw"),function(){function e(e){this.TAG="MP4Demuxer",this.state=1e3,this.onCodecFound=null,this.onSeek=null,this.initData={},this.sttsInfo={video:[],audio:[]},this.stszInfo={video:[],audio:[]},this.cttsInfo={video:[],audio:[]},this.stcoInfo={video:[],audio:[]},this.entry_idx_per_chunk={video:[0],audio:[0]},this.IDRFrameIdx=[],this._mdatCTX=null,this.finish=!1,this.tracks={video:{type:"video",id:1,sequenceNumber:0,samples:[],length:0},audio:{type:"audio",id:2,sequenceNumber:0,samples:[],length:0}},this._silentTrack={type:"silent",id:1,sequenceNumber:0,samples:[],length:0},this.onDataAvailable=null,this.onTrackMetadata=null,this.nearChunkIdx={video:0,audio:0},this._MP4Player=e}var t=e.prototype;return t.destroy=function(){this._MP4Player=null,this.initData={},this.finish=!1},t.parseChunks=function(e,t){if(this.finish)return e.byteLength;if(e.byteLength<8)return 0;for(var n={offset:0,total_offset:t},i=!1,r=new Uint8Array(e);r.byteLength-n.offset>=8&&!i;)switch(this.state){case 1001:i=!this._parseMOOV(r,n);break;case 1002:i=!this._parseMDAT(r,n),this._toRemuxer();break;case 1e3:i=!this._parseBOX(r,n);break;default:throw"unknown state"+this.state}return n.offset},t.seekto=function(t){if(this.initData.video){var n=Math.round(t*this.initData.video.timescale),i=e.binarySearchNear(this.sttsInfo.video,n),r=e.binarySearchNear(this.IDRFrameIdx,i);if(null!=r){this.IDRFrameIdx[r]>i&&(r=Math.max(r-1,0));var a=this.IDRFrameIdx[r],s=(this.sttsInfo.video[a],this.initData.video.timescale,e.binarySearchNear(this.entry_idx_per_chunk.video,a));this.entry_idx_per_chunk.video[s]>a&&s--;var o=this.stcoInfo.video[s];if(this.nearChunkIdx.video=s,this.initData.audio){var u=e.binarySearchNear(this.stcoInfo.audio,o);this.stcoInfo.audio[u]<o&&u++,this.nearChunkIdx.audio=u}this._mdatCTX.offsetInMDAT=o-this._mdatCTX.startOffsetInFile,this._mdatCTX.chunk=null,this.finish=!1,this.state=1002,this._lastFakePcmPts=void 0,this.tracks.audio.discontinuity=!0,this._silentTrack.discontinuity=!0,this.onSeek(o,t)}else p.e(this.TAG,"can not find key frame information")}},t._parseBOX=function(t,n){var i=e.readUint32(t,n.offset),r=e.bin2str(t.subarray(n.offset+4,n.offset+8));return"mdat"===r?(p.v(this.TAG,"parseBOX "+r),this.state=1002,!0):!(t.byteLength-n.offset<i)&&(p.v(this.TAG,"parseBOX "+r),"moov"===r?this.state=1001:n.offset+=i,!0)},t._parseMDAT=function(t,n){if(!this._mdatCTX){var i=e.readUint32(t,n.offset);if(this._mdatCTX={},this._mdatCTX.offsetInMDAT=8,this._mdatCTX.startOffsetInFile=n.total_offset+n.offset,this._mdatCTX.boxLen=i,this._mdatCTX.chunk=void 0,n.offset+=8,!this.initData.video)return this.onSeek(this._mdatCTX.startOffsetInFile+i),this.state=1e3,n.offset=-1,!1}for(var r,a=this._mdatCTX;;){if(this._mdatCTX.chunk)r=this._mdatCTX.chunk;else{if(!(r=this._searchNearChunk(a.offsetInMDAT+a.startOffsetInFile,n)))break;r.currentEntry=void 0,this._mdatCTX.chunk=r}for(var s=this.entry_idx_per_chunk[r.type][r.idx],o=this.entry_idx_per_chunk[r.type][r.idx+1],u=null==r.currentEntry?s:r.currentEntry;u<o;u++){r.currentEntry=u;if(0==("video"==r.type?this.videoChunkEntry(r,t,n,u):this.audioChunkEntry(r,t,n,u)))return!1}a.chunk=null}return!1},t.videoChunkEntry=function(e,t,n,i){var r=this.stszInfo[e.type][i];if(r>t.byteLength-n.offset)return!1;for(var a=0,s=new DataView(t.buffer,n.offset,r),o=[],u=0,d=!1,l=this.sttsInfo[e.type][i],c=this.cttsInfo[e.type][i]||0;a<r;){var h=s.getUint32(a);if(0==h||h>r)break;var f=(126&s.getUint8(a+4))>>>1;if(f>21)a+=h+4;else{f>=16&&f<=21&&(d=!0);var m=new Uint8Array(s.buffer,a+n.offset,4+h),_={type:f,data:m};o.push(_),u+=m.byteLength,a+=4+h}}if(a!==r)p.e(this.TAG,"off !== entry_size, drop this entry.");else if(o.length){var v=this.tracks[e.type],g={units:o,length:u,isKeyframe:d,dts:l,cts:c,pts:l+c,sample_index:i};v.samples.push(g),v.length+=u}return n.offset+=r,this._mdatCTX.offsetInMDAT+=r,!0},t.audioChunkEntry=function(e,t,n,i){var r=this.stszInfo[e.type][i];if(r>t.byteLength-n.offset)return!1;var a=this.sttsInfo[e.type][i],s=new Uint8Array(t.buffer,n.offset,r);if(r){var o=this.tracks[e.type],u={unit:s,length:s.byteLength,dts:a,pts:a};o.samples.push(u),o.length+=s.byteLength}return n.offset+=r,this._mdatCTX.offsetInMDAT+=r,!0},t._searchNearChunk=function(e,t){var n,i,r=this.stcoInfo.video[this.nearChunkIdx.video],a=this.stcoInfo.audio[this.nearChunkIdx.audio];if(null==r&&void 0===a)return p.v(this.TAG,"_searchNearChunk end"),void(this.state=1e3);do{if(null==r){n="audio",i=a-e;break}if(null==a){n="video",i=r-e;break}var s=r-e,o=a-e;s>o?(i=o,n="audio"):(i=s,n="video")}while(0);return this._mdatCTX.offsetInMDAT+=i,t.offset+=i,"audio"==n?{type:"audio",offsetInFile:a,idx:this.nearChunkIdx.audio++}:{type:"video",offsetInFile:r,idx:this.nearChunkIdx.video++}},t._toRemuxer=function(){var e=this.tracks.video,t=this.tracks.audio;if(0!=e.samples.length||0!=t.samples.length){var n={samplerate:8e3,samples:[],inputTimeScale:1e3,totalSize:0};e.samples.length>0&&(this._generateFakePcm(n,e),this._silentTrack.samples=this._silentTrack.samples.concat(n.samples),this._silentTrack.length+=n.totalSize),this.onDataAvailable(t,e,this._silentTrack)}},t._parseMOOV=function(t,n){var i=this,r=e.readUint32(t,n.offset);if(t.byteLength-n.offset<r)return!1;if(this.initData.video)return n.offset+=r,!0;var a=t.subarray(n.offset,n.offset+r),s=this.initData;if(e.findBox(a,["moov","trak"]).forEach((function(t){var n=e.findBox(t,["tkhd"])[0];if(n){var r=n.data[n.start],a=0===r?12:20,o=e.readUint32(n,a),u=e.findBox(t,["mdia","mdhd"])[0];if(u){a=0===(r=u.data[u.start])?12:20;var d=e.readUint32(u,a),l=e.readUint32(u,a+4),c=e.findBox(t,["mdia","hdlr"])[0];if(c){var h={soun:"audio",vide:"video"}[e.bin2str(c.data.subarray(c.start+8,c.start+12))];if(h){s[o]={timescale:d,type:h},s[h]={timescale:d,id:o,duration:l};var f=e.findBox(t,["mdia","minf","stbl","stsd"])[0],m=e.bin2str(f.data.subarray(f.start+12,f.start+16));if(p(i.TAG,"find "+h+":"+m),"video"===h){if("hev1"===m||"hvc1"===m){var _=e.readUint32(f,94)-8,v=new Uint8Array(_);v.set(f.data.subarray(f.start+102,f.start+102+_),0);var g=e._parseHVCC(v.buffer,0,_);s[h].codecs=g.codecs,s[h].codec=s[h].codecs,s[h].width=g.codec_size.width,s[h].height=g.codec_size.height,s[h].hvcc=v}else if("avc1"===m){var y=e.readUint32(f,94)-8,E=new Uint8Array(y);E.set(f.data.subarray(f.start+102,f.start+102+y),0);var b=e._parseAVCC(E.buffer,0,y);s[h].codecs=b.codecs,s[h].codec=s[h].codecs,s[h].width=b.codec_size.width,s[h].height=b.codec_size.height,s[h].avcc=E}}else if("audio"===h&&(s[h].channelCount=e.readUint16(f,32),s[h].sampleSize=e.readUint16(f,34),s[h].audioSampleRate=e.readUint16(f,40),s[h].codecs="mp4a"===m?"mp4a.40.5":"alaw",s[h].codec=s[h].codecs,"flac"!==s[h].codecs)){var w=e.readUint32(f,8),S=new Uint8Array(w);S.set(f.data.subarray(f.start+8,f.start+8+w),0),s[h].mp4a=S,s[h].refSampleDuration=1024/s[h].audioSampleRate*s[h].timescale}var A=e.findBox(t,["mdia","minf","stbl"])[0];i._parseSTTS(e.findBox(A,["stts"])[0],h),i._parseSTSZ(e.findBox(A,["stsz"])[0],h),i._parseCTTS(e.findBox(A,["ctts"])[0],h),i._parseSTSS(e.findBox(A,["stss"])[0],h),i._parseSTCO(e.findBox(A,["stco"])[0],h),i._parseSTSC(e.findBox(A,["stsc"])[0],h)}}}}})),-1!==s.video.codecs.indexOf("hev1")&&0==N){if(this.onCodecFound("canvas"),s.silence={timescale:1e3,id:1,type:"audio",duration:Math.round(s.video.duration/s.video.timescale*1e3),codec:"flac",codecs:"flac",channelCount:1,audioSampleRate:8e3,refSampleDuration:40},this.onTrackMetadata("silent",s.silence),s.audio&&(this.onTrackMetadata("audio",s.audio),s.audio.mp4a=null),this._MP4Player._wasmPlayer.createVideoDecoder(s.video.width,s.video.height,s.video.timescale,s.video.hvcc),s.video.hvcc=null,this.tracks.video.inputTimeScale=s.video.timescale,this.tracks.video.has_length_header=!0,this.tracks.video.isH265=!0,this._MP4Player._wasmPlayer.loadVideo(),this.finish=!1,this._mdatCTX)return this.onSeek(this._mdatCTX.startOffsetInFile),this._mdatCTX=null,this.state=1002,n.offset=-1,!1}else this.onCodecFound("video"),this.finish=!0;return n.offset+=r,this.state=1e3,!this.finish},t._parseSTTS=function(t,n){var i=e.readUint32(t,4),r=8,a=this.sttsInfo[n];for(0==a.length&&a.push(0);i--;){var s=e.readUint32(t,r),o=e.readUint32(t,r+4);for(r+=8;s--;){var u=a[a.length-1];a.push(u+o)}}},t._parseSTSZ=function(t,n){var i=e.readUint32(t,4),r=e.readUint32(t,8);if(i>0)for(;r--;)this.stszInfo[n].push(i);else for(var a=12;r--;)i=e.readUint32(t,a),a+=4,this.stszInfo[n].push(i)},t._parseSTSS=function(t,n){if(t&&"video"==n)for(var i=e.readUint32(t,4),r=8;i--;)this.IDRFrameIdx.push(e.readUint32(t,r)-1),r+=4},t._parseCTTS=function(t,n){if(t){t.data[0];for(var i=e.readUint32(t,4),r=8,a=this.cttsInfo[n];i--;){var s=e.readUint32(t,r),o=e.readUint32(t,r+4);for(r+=8;s--;)a.push(o)}}},t._parseSTCO=function(t,n){for(var i=e.readUint32(t,4),r=8;i--;){var a=e.readUint32(t,r);r+=4,this.stcoInfo[n].push(a)}},t._parseSTSC=function(t,n){if(t)for(var i,r=e.readUint32(t,4),a=0,s=this.entry_idx_per_chunk[n],o=this.stcoInfo[n],u=8,d=function(){var n={idx:void 0,num:void 0};return a>=r||(n.idx=e.readUint32(t,u)-1,n.num=e.readUint32(t,u+4),u+=12,a++),n},l=d(),c=0;c<o.length;c++)l.idx===c&&(i=l,l=d()),s[c+1]=i.num+s[c];else p.e(this.TAG,"can not find STSC box")},t._generateFakePcm=function(e,t){if(0!==t.samples.length){null==this._lastFakePcmPts&&(this._lastFakePcmPts=Math.round(t.samples[0].dts/t.inputTimeScale*1e3));for(var n=0;n<t.samples.length;n++)for(var i=Math.round(t.samples[n].dts/t.inputTimeScale*1e3);i>=this._lastFakePcmPts;)if(i-this._lastFakePcmPts>3e3)this._lastFakePcmPts=i;else{var r=new Uint8Array(651);r.set([255,248,116,8,0,1,63,61,2],0),r.set([90,64],649),e.samples.push({dts:this._lastFakePcmPts,pts:this._lastFakePcmPts,unit:r,length:r.byteLength}),e.totalSize+=r.byteLength,this._lastFakePcmPts+=40}}},e._parseHVCC=function(e,t,n){if(n<23)console.log("Invalid HVCC, lack of data!");else{var i=new DataView(e,t,n),r=i.getUint8(0);if(0===i.getUint8(1)&&(console.warn("general_profile_idc == 0, codec parser may fail"),i.setUint8(1,1)),1===r){var a=1+(3&i.getUint8(21));if(3===a||4===a){var s=i.getUint8(22);if(0!==s){for(var o,u=23,d=null,l=0;l<s;l++){var c=63&i.getUint8(u),h=i.getUint16(u+1,!1);u+=3;for(var f=0;f<h;f++){var m=i.getUint16(u);u+=2,33===c&&null==d&&(o=new Uint8Array(e,t+u,m),d=C.parseH265SPS(o)),u+=m}}if(o&&d)return d;console.error("HVCC can not find sps")}else console.error("Flv: Invalid HVCC: No SPS")}else console.error("Strange NaluLengthSizeMinusOne: "+(a-1))}else console.error("Invalid HVCC")}},e._parseAVCC=function(e,t,n){if(n<7)console.error("Invalid AVCDecoderConfigurationRecord, lack of data!");else{var i=new DataView(e,t,n),r=i.getUint8(0),a=i.getUint8(1);i.getUint8(2),i.getUint8(3);if(1===r&&0!==a){var s=1+(3&i.getUint8(4));if(3===s||4===s){var o=31&i.getUint8(5);if(0!==o){o>1&&console.warn("Flv: Strange AVCDecoderConfigurationRecord: SPS Count = "+o);for(var u,d=6,l=0;l<o;l++){var c=i.getUint16(d,!1);if(d+=2,0!==c){var h=new Uint8Array(e,t+d,c);if(d+=c,u=C.parseSPS(h),0===l){for(var f=h.subarray(1,4),m="avc1.",_=0;_<3;_++){var p=f[_].toString(16);p.length<2&&(p="0"+p),m+=p}u.codecs=m}}}return u}console.error("Flv: Invalid AVCDecoderConfigurationRecord: No SPS")}else console.error("Hls: Strange NaluLengthSizeMinusOne: "+(s-1))}else console.error("Hls: Invalid AVCDecoderConfigurationRecord")}},e.findBox=function(t,n){var i,r,a,s,o,u,d=[];if(t.data?(o=t.start,a=t.end,t=t.data):(o=0,a=t.byteLength),!n.length)return null;for(i=o;i<a;)u=(r=e.readUint32(t,i))>1?i+r:a,e.bin2str(t.subarray(i+4,i+8))===n[0]&&(1===n.length?d.push({data:t,start:i+8,end:u}):(s=e.findBox({data:t,start:i+8,end:u},n.slice(1))).length&&(d=d.concat(s))),i=u;return d},e.readUint16=function(e,t){e.data&&(t+=e.start,e=e.data);var n=e[t]<<8|e[t+1];return n<0?65536+n:n},e.readUint32=function(e,t){e.data&&(t+=e.start,e=e.data);var n=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return n<0?4294967296+n:n},e.bin2str=function(e){return String.fromCharCode.apply(null,e)},e.binarySearchNear=function(e,t){if(0!=e.length){if(e[0]>=t)return 0;if(e[e.length-1]<=t)return e.length-1;for(var n,i=0,r=e.length-1;;){if(r-i==1){n=e[r]-t<t-e[i]?r:i;break}var a=Math.floor((r+i)/2);e[a]>t?r=a:i=a}return n}},e}()),G=function(){function e(){}return e.getConfig=function(){return{globalTag:p.GLOBAL_TAG,forceGlobalTag:p.FORCE_GLOBAL_TAG,enableVerbose:p.ENABLE_VERBOSE,enableDebug:p.ENABLE_DEBUG,enableInfo:p.ENABLE_INFO,enableWarn:p.ENABLE_WARN,enableError:p.ENABLE_ERROR,enableCallback:p.ENABLE_CALLBACK}},e.applyConfig=function(e){p.GLOBAL_TAG=e.globalTag,p.FORCE_GLOBAL_TAG=e.forceGlobalTag,p.ENABLE_VERBOSE=e.enableVerbose,p.ENABLE_DEBUG=e.enableDebug,p.ENABLE_INFO=e.enableInfo,p.ENABLE_WARN=e.enableWarn,p.ENABLE_ERROR=e.enableError,p.ENABLE_CALLBACK=e.enableCallback},e._notifyChange=function(){var t=e.emitter;if(t.listenerCount("change")>0){var n=e.getConfig();t.emit("change",n)}},e.registerListener=function(t){e.emitter.addListener("change",t)},e.removeListener=function(t){e.emitter.removeListener("change",t)},e.addLogListener=function(t){p.emitter.addListener("log",t),p.emitter.listenerCount("log")>0&&(p.ENABLE_CALLBACK=!0,e._notifyChange())},e.removeLogListener=function(t){p.emitter.removeListener("log",t),0===p.emitter.listenerCount("log")&&(p.ENABLE_CALLBACK=!1,e._notifyChange())},r()(e,null,[{key:"forceGlobalTag",get:function(){return p.FORCE_GLOBAL_TAG},set:function(t){p.FORCE_GLOBAL_TAG=t,e._notifyChange()}},{key:"globalTag",get:function(){return p.GLOBAL_TAG},set:function(t){p.GLOBAL_TAG=t,e._notifyChange()}},{key:"enableAll",get:function(){return p.ENABLE_VERBOSE&&p.ENABLE_DEBUG&&p.ENABLE_INFO&&p.ENABLE_WARN&&p.ENABLE_ERROR},set:function(t){p.ENABLE_VERBOSE=t,p.ENABLE_DEBUG=t,p.ENABLE_INFO=t,p.ENABLE_WARN=t,p.ENABLE_ERROR=t,e._notifyChange()}},{key:"enableDebug",get:function(){return p.ENABLE_DEBUG},set:function(t){p.ENABLE_DEBUG=t,e._notifyChange()}},{key:"enableVerbose",get:function(){return p.ENABLE_VERBOSE},set:function(t){p.ENABLE_VERBOSE=t,e._notifyChange()}},{key:"enableInfo",get:function(){return p.ENABLE_INFO},set:function(t){p.ENABLE_INFO=t,e._notifyChange()}},{key:"enableWarn",get:function(){return p.ENABLE_WARN},set:function(t){p.ENABLE_WARN=t,e._notifyChange()}},{key:"enableError",get:function(){return p.ENABLE_ERROR},set:function(t){p.ENABLE_ERROR=t,e._notifyChange()}}]),e}();G.emitter=new m.a;var W=G,V={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full"},H=function(){function e(e,t){this.TAG=t+"MSEController",this._config=e,this._emitter=new m.a,this._config.isLive&&null==this._config.autoCleanupSourceBuffer&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this),onMediaPlay:this._onMediaPlay.bind(this),onMediaPause:this._onMediaPause.bind(this),onMediaWaiting:this._onMediaWaiting.bind(this),skipRange:this._skipRange.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new M,this.suspend=!1,this._receivedCanPlay=!1,this._waitingTimer=null,this._livePaused=!1}var t=e.prototype;return t.destroy=function(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},t.on=function(e,t){this._emitter.addListener(e,t)},t.off=function(e,t){this._emitter.removeListener(e,t)},t.attachMediaElement=function(e){if(this._mediaSource)throw new l("MediaSource has been attached to an HTMLMediaElement!");var t=this._mediaSource=new window.MediaSource;t.addEventListener("sourceopen",this.e.onSourceOpen),t.addEventListener("sourceended",this.e.onSourceEnded),t.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=e,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),e.src=this._mediaSourceObjectURL,this._mediaElement.addEventListener("canplay",this.e.onvCanPlay),this._mediaElement.addEventListener("stalled",this.e.onvStalled),this._mediaElement.addEventListener("progress",this.e.onvProgress),this._mediaElement.addEventListener("play",this.e.onMediaPlay),this._mediaElement.addEventListener("pause",this.e.onMediaPause),this._mediaElement.addEventListener("waiting",this.e.onMediaWaiting),this._receivedCanPlay=!1},t.detachMediaElement=function(){if(this._mediaSource){var e=this._mediaSource;for(var t in this._sourceBuffers){var n=this._pendingSegments[t];n.splice(0,n.length),this._pendingSegments[t]=null,this._pendingRemoveRanges[t]=null,this._lastInitSegments[t]=null;var i=this._sourceBuffers[t];if(i){if("closed"!==e.readyState){try{e.removeSourceBuffer(i)}catch(e){p.e(this.TAG,e.message)}i.removeEventListener("error",this.e.onSourceBufferError),i.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[t]=null,this._sourceBuffers[t]=null}}if("open"===e.readyState)try{e.endOfStream()}catch(e){p.e(this.TAG,e.message)}e.removeEventListener("sourceopen",this.e.onSourceOpen),e.removeEventListener("sourceended",this.e.onSourceEnded),e.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement.removeEventListener("play",this.e.onMediaPlay),this._mediaElement.removeEventListener("pause",this.e.onMediaPause),this._mediaElement.removeEventListener("waiting",this.e.onMediaWaiting),this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null),this._waitingTimer&&(clearTimeout(this._waitingTimer),this._waitingTimer=null),this._livePaused=!1},t.appendInitSegment=function(e,t){if(!this._mediaSource||"open"!==this._mediaSource.readyState)return this._pendingSourceBufferInit.push(e),this._pendingSegments[e.type].push(e),!1;var n=e,i=""+n.container;n.codec&&n.codec.length>0&&(i+=";codecs="+n.codec);var r=!1;if(p.v(this.TAG,"Received Initialization Segment, mimeType: "+i),i!==this._mimeTypes[n.type]){if(this._mimeTypes[n.type])p.v(this.TAG,"Notice: "+n.type+" mimeType changed, origin: "+this._mimeTypes[n.type]+", target: "+i);else{if(this._mediaSource.activeSourceBuffers.length>0)return void p.e(this.TAG,"adding "+n.type+" SourceBuffer, but activeSourceBuffers.length = "+this._mediaSource.activeSourceBuffers.length);r=!0;try{p.v(this.TAG,"adding SourceBuffer, mimeType: "+i);var a=this._sourceBuffers[n.type]=this._mediaSource.addSourceBuffer(i);a.addEventListener("error",this.e.onSourceBufferError),a.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(e){return p.e(this.TAG,e.message),void this._emitter.emit(V.ERROR,{code:e.code,msg:e.message})}}this._mimeTypes[n.type]=i}else if(0===this._mediaSource.activeSourceBuffers.length)return;this._lastInitSegments[n.type]=n,t||this._pendingSegments[n.type].push(n),r||this._sourceBuffers[n.type]&&!this._sourceBuffers[n.type].updating&&this._doAppendSegments(),u.safari&&"audio/mpeg"===n.container&&n.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=n.mediaDuration/1e3,this._updateMediaSourceDuration())},t.appendMediaSegment=function(e){var t=e;if(this._pendingSegments[t.type].push(t),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer(),!0!==this.suspend){var n=this._sourceBuffers[t.type];!n||n.updating||this._hasPendingRemoveRanges()||this._doAppendSegments()}},t.seek=function(e){for(var t in this._sourceBuffers)if(this._sourceBuffers[t]){var n=this._sourceBuffers[t];if("open"===this._mediaSource.readyState)try{n.abort()}catch(e){p.e(this.TAG,e.message)}this._idrList.clear();var i=this._pendingSegments[t];if(i.splice(0,i.length),"closed"!==this._mediaSource.readyState){for(var r=0;r<n.buffered.length;r++){var a=n.buffered.start(r),s=n.buffered.end(r);this._pendingRemoveRanges[t].push({start:a,end:s})}if(n.updating||this._doRemoveRanges(),u.safari){var o=this._lastInitSegments[t];o&&(this._pendingSegments[t].push(o),n.updating||this._doAppendSegments())}}}},t.endOfStream=function(){var e=this._mediaSource,t=this._sourceBuffers;e&&"open"===e.readyState?t.video&&t.video.updating||t.audio&&t.audio.updating||this._hasPendingSegments()?this._hasPendingEos=!0:(this._hasPendingEos=!1,e.endOfStream()):e&&"closed"===e.readyState&&this._hasPendingSegments()&&(this._hasPendingEos=!0)},t.getNearestKeyframe=function(e){return this._idrList.getLastSyncPointBeforeDts(e)},t._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var e=this._mediaElement.currentTime;for(var t in this._sourceBuffers){var n=this._sourceBuffers[t];if(n){var i=n.buffered;if(i.length>=1&&e-i.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},t._doCleanupSourceBuffer=function(){var e=this._mediaElement.currentTime;for(var t in this._sourceBuffers){var n=this._sourceBuffers[t];if(n){for(var i=n.buffered,r=!1,a=0;a<i.length;a++){var s=i.start(a),o=i.end(a);if(s<=e&&e<o+3){if(e-s>=this._config.autoCleanupMaxBackwardDuration){r=!0;var u=e-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[t].push({start:s,end:u})}}else o<e&&(r=!0,this._pendingRemoveRanges[t].push({start:s,end:o}))}r&&!n.updating&&this._doRemoveRanges()}}},t._updateMediaSourceDuration=function(){var e=this._sourceBuffers;if(0!==this._mediaElement.readyState&&"open"===this._mediaSource.readyState&&!(e.video&&e.video.updating||e.audio&&e.audio.updating)){var t=this._mediaSource.duration,n=this._pendingMediaDuration;n>0&&(isNaN(t)||n>t)&&(p.v(this.TAG,"Update MediaSource duration from "+t+" to "+n),this._mediaSource.duration=n),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},t._doRemoveRanges=function(){for(var e in this._pendingRemoveRanges)if(this._sourceBuffers[e]&&!this._sourceBuffers[e].updating)for(var t=this._sourceBuffers[e],n=this._pendingRemoveRanges[e];n.length&&!t.updating;){var i=n.shift();t.remove(i.start,i.end)}},t._doAppendSegments=function(){var e=this._pendingSegments;for(var t in e)if(this._sourceBuffers[t]&&!this._sourceBuffers[t].updating&&e[t].length>0){var n=e[t].shift();if(n.timestampOffset){var i=this._sourceBuffers[t].timestampOffset,r=n.timestampOffset/1e3;Math.abs(i-r)>.1&&(p.v(this.TAG,"Update MPEG audio timestampOffset from "+i+" to "+r),this._sourceBuffers[t].timestampOffset=r),delete n.timestampOffset}if(!n.data||0===n.data.byteLength)continue;try{this._sourceBuffers[t].appendBuffer(n.data),this._isBufferFull=!1,"video"===t&&n.hasOwnProperty("info")&&this._idrList.appendArray(n.info.syncPoints)}catch(e){this._pendingSegments[t].unshift(n),22===e.code?(this._isBufferFull||this._emitter.emit(V.BUFFER_FULL),this._isBufferFull=!0):(p.e(this.TAG,"123"+e.message),this._emitter.emit(V.ERROR,{code:e.code,msg:e.message}))}}},t._onSourceOpen=function(){if(p.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var e=this._pendingSourceBufferInit;e.length;){var t=e.shift();if(!1===this.appendInitSegment(t,!0))throw"sourceopen event triggered, but mediaSource.readyState !== open"}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(V.SOURCE_OPEN)},t._onSourceEnded=function(){p.v(this.TAG,"MediaSource onSourceEnded")},t._onSourceClose=function(){p.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&null!=this.e&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose))},t._hasPendingSegments=function(){var e=this._pendingSegments;return e.video.length>0||e.audio.length>0},t._hasPendingRemoveRanges=function(){var e=this._pendingRemoveRanges;return e.video.length>0||e.audio.length>0},t._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(V.UPDATE_END)},t._onSourceBufferError=function(e){p.e(this.TAG,"SourceBuffer Error: "+e)},t._onMediaPlay=function(){this._livePaused=!1},t._onMediaPause=function(){this._config.isLive&&(this.seek(0),this._onMediaWaiting(),this._livePaused=!0)},t._onMediaWaiting=function(){null==this._waitingTimer&&(this._waitingTimestamp=this._mediaElement.currentTime,this._waitingTimer=setTimeout(this.e.skipRange,200))},t._skipRange=function(){this._waitingTimer=null;var e=this._mediaElement.buffered;if(0!==e.length){var t=this._mediaElement.currentTime;if(this._waitingTimestamp!==t)if(t>=e.start(e.length-1))return this._skipRangeSeeked&&p.v(this.TAG,"changed currentTime "+this._waitingTimestamp.toFixed(3)+" to "+t.toFixed(3)),this._skipRangeSeeked=!1,void(this._nudge=0);for(var n=0,i=0;i<e.length;i++){var r=e.start(i),a=e.end(i);if(t>=r&&t<=a){n=i;break}if(t<r){n=i-1;break}}n+1<e.length&&(this._mediaElement.currentTime=e.start(n+1),this._skipRangeSeeked=!0),this._waitingTimer=setTimeout(this.e.skipRange,200)}else this._waitingTimer=setTimeout(this.e.skipRange,200)},t._checkAndResumeStuckPlayback=function(e){if(this._mediaElement){var t=this._mediaElement;if(e||!this._receivedCanPlay||t.readyState<2){var n=t.buffered;n.length>0&&t.currentTime<n.start(0)&&(p.w(this.TAG,"Playback seems stuck at "+t.currentTime+", seek to "+n.start(0)),this._requestSetTime=!0,t.currentTime=n.start(0),t.removeEventListener("progress",this.e.onvProgress))}else t.removeEventListener("progress",this.e.onvProgress)}},t._onvCanPlay=function(e){this._receivedCanPlay=!0,this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay)},t._onvStalled=function(e){this._checkAndResumeStuckPlayback(!0)},t._onvProgress=function(e){this._checkAndResumeStuckPlayback()},e}();function j(e){this.gl=e,this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}function z(e,t){this.canvas=e;var n=!0===t.preserveDrawingBuffer;this.gl=e.getContext("webgl",{preserveDrawingBuffer:n})||e.getContext("experimental-webgl",{preserveDrawingBuffer:n}),this.initGL(t)}j.prototype.bind=function(e,t,n){var i=this.gl;i.activeTexture([i.TEXTURE0,i.TEXTURE1,i.TEXTURE2][e]),i.bindTexture(i.TEXTURE_2D,this.texture),i.uniform1i(i.getUniformLocation(t,n),e)},j.prototype.fill=function(e,t,n){var i=this.gl;i.bindTexture(i.TEXTURE_2D,this.texture),i.texImage2D(i.TEXTURE_2D,0,i.LUMINANCE,e,t,0,i.LUMINANCE,i.UNSIGNED_BYTE,n)},z.prototype.initGL=function(e){if(this.gl){var t=this.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,1);var n=t.createProgram(),i=["attribute highp vec4 aVertexPosition;","attribute vec2 aTextureCoord;","varying highp vec2 vTextureCoord;","void main(void) {"," gl_Position = aVertexPosition;"," vTextureCoord = aTextureCoord;","}"].join("\n"),r=t.createShader(t.VERTEX_SHADER);t.shaderSource(r,i),t.compileShader(r);var a=["precision highp float;","varying lowp vec2 vTextureCoord;","uniform sampler2D YTexture;","uniform sampler2D UTexture;","uniform sampler2D VTexture;","const mat4 YUV2RGB = mat4","("," 1.1643828125, 0, 1.59602734375, -.87078515625,"," 1.1643828125, -.39176171875, -.81296875, .52959375,"," 1.1643828125, 2.017234375, 0, -1.081390625,"," 0, 0, 0, 1",");","void main(void) {"," gl_FragColor = vec4( texture2D(YTexture, vTextureCoord).x, texture2D(UTexture, vTextureCoord).x, texture2D(VTexture, vTextureCoord).x, 1) * YUV2RGB;","}"].join("\n"),s=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(s,a),t.compileShader(s),t.attachShader(n,r),t.attachShader(n,s),t.linkProgram(n),t.useProgram(n),t.getProgramParameter(n,t.LINK_STATUS)||console.log("[ER] Shader link failed.");var o=t.getAttribLocation(n,"aVertexPosition");t.enableVertexAttribArray(o);var u=t.getAttribLocation(n,"aTextureCoord");t.enableVertexAttribArray(u);var d=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,d),t.bufferData(t.ARRAY_BUFFER,new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0]),t.STATIC_DRAW),t.vertexAttribPointer(o,3,t.FLOAT,!1,0,0);var l=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,l),t.bufferData(t.ARRAY_BUFFER,new Float32Array([1,0,0,0,1,1,0,1]),t.STATIC_DRAW),t.vertexAttribPointer(u,2,t.FLOAT,!1,0,0),t.y=new j(t),t.u=new j(t),t.v=new j(t),t.y.bind(0,n,"YTexture"),t.u.bind(1,n,"UTexture"),t.v.bind(2,n,"VTexture")}else console.log("[ER] WebGL not supported.")},z.prototype.renderFrame=function(e,t,n,i,r){if(this.gl){var a=this.gl;a.viewport(0,0,a.canvas.width,a.canvas.height),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT),a.y.fill(t,n,e.subarray(0,i)),a.u.fill(t>>1,n>>1,e.subarray(i,i+r)),a.v.fill(t>>1,n>>1,e.subarray(i+r,e.length)),a.drawArrays(a.TRIANGLE_STRIP,0,4)}else console.log("[ER] Render frame failed due to WebGL not supported.")};var X,K,q,Y=z,Z=n(0),Q=n(4),J=function(){function e(e){this.TAG="wasmPlayerA",this.canvas=null,this.audioElement=null,this.webglPlayer=null,this.frameInterval_s=0,this.beginTimeOffset=0,this.compensation=0,this.playerState=0,this.hasAudio=!0,this.playbackRate=1,this.videoFrameBuf=[],this.pendingCmd=[],this.firstFrame=!0,this.frameCount={decoded:0,dropped:0},this.canplayCb=null,this.lastDisplayPts=0,this.lastVideoPts=1e-4,this.lastVideoDts=-1,this.tabVisible=!0,this.needIDRPts=-1,this.seekingTime=-1,this.gopSize_s=2,this.maxBufferFrameNum=25,this.e={onFullscreen:this.fullscreenListener.bind(this),displayFirstFrame:this.displayFirstFrame.bind(this),displayLoop:this.displayLoop.bind(this),onVisibleChange:this.onVisibleChange.bind(this),onPause:this.pause.bind(this)},e&&("number"==typeof e.startPosition&&(this.seekingTime=e.startPosition),null!=e.displayQueueTimeLength&&(this.maxBufferFrameNum=e.displayQueueTimeLength),this.enableWebGLDrawingBuffer=e.enableWebGLDrawingBuffer,Z.a.ENABLE_ERROR=null!=e.ENABLE_ERROR?e.ENABLE_ERROR:Z.a.ENABLE_ERROR,Z.a.ENABLE_INFO=null!=e.ENABLE_INFO?e.ENABLE_INFO:Z.a.ENABLE_INFO,Z.a.ENABLE_WARN=null!=e.ENABLE_WARN?e.ENABLE_WARN:Z.a.ENABLE_WARN,Z.a.ENABLE_DEBUG=null!=e.ENABLE_DEBUG?e.ENABLE_DEBUG:Z.a.ENABLE_DEBUG,Z.a.ENABLE_VERBOSE=null!=e.ENABLE_VERBOSE?e.ENABLE_VERBOSE:Z.a.ENABLE_VERBOSE);var t=this;this.Module={},this.Module.wasmLoaded=!1,!1===this.Module.wasmLoaded&&(this.Module.onRuntimeInitialized=function(){Z.a.v(this.TAG,"wasm load"),t.Module._setLog(!0===Z.a.ENABLE_VERBOSE?1:0),t.Module.wasmLoaded=!0;for(var e=t.pendingCmd.length,n=0;n<e;n++){t.pendingCmd.shift()()}},Object(Q.a)(X,this.Module).then((function(e){t.Module=e})))}var t=e.prototype;return t.on=function(e,t){this.hasAudio&&this.audioElement&&this.audioElement.addEventListener(e,t,arguments[2],arguments[3])},t.off=function(e,t){this.hasAudio&&this.audioElement&&this.audioElement.removeEventListener(e,t,arguments[2])},t.attachMediaElement=function(e,t){this.canvas=e,this.audioElement=t,document.addEventListener("fullscreenchange",this.e.onFullscreen),document.addEventListener("webkitfullscreenchange",this.e.onFullscreen),document.addEventListener("mozfullscreenchange",this.e.onFullscreen),document.addEventListener("MSFullscreenChange",this.e.onFullscreen),this.audioElement.addEventListener("pause",this.e.onPause)},t.detachMediaElement=function(){null!=this.canvas&&(document.removeEventListener("fullscreenchange",this.e.onFullscreen),document.removeEventListener("webkitfullscreenchange",this.e.onFullscreen),document.removeEventListener("mozfullscreenchange",this.e.onFullscreen),document.removeEventListener("MSFullscreenChange",this.e.onFullscreen),this.canvas=null,null!=this.audioElement&&(this.audioElement.removeEventListener("pause",this.e.onPause),this.audioElement=null))},t.seekto=function(e){!0===this.Module.wasmLoaded&&(this.seekingTime=e,this.Module._pauseDecoding(1),this.Module._cleanFifo(),this.videoFrameBuf=[],this.Module._startDecoding(1),this.needIDRPts=-1,this.lastVideoDts=-1,e>=0&&!0===this.hasAudio&&(this.audioElement.currentTime=e))},t.fullscreenListener=function(){this.Module&&(document.fullscreenElement?(Z.a.v(this.TAG,"fullscreenchange entering"),this.Module._doResize(0)):(Z.a.v(this.TAG,"fullscreenchange leaving"),this.Module._doResize(1)))},t.timeNow=function(){return this.audioElement?this.audioElement.currentTime:0===this.videoFrameBuf.length?0:this.videoFrameBuf[0].s},t.notifyGopSize=function(e){e>0&&(this.gopSize_s=e)},t.feedChunk=function(e){var t=this,n=this;if(!0!==this.Module.wasmLoaded){var i=Object.assign({},e);return e.samples=[],void this.pendingCmd.push((function(){n.feedChunk(i)}))}var r=e.has_length_header||!1;0===this.frameInterval_s&&(this.frameInterval_s=e.defaultInterval/e.inputTimeScale,this.maxBufferFrameNum=Math.max(this.maxBufferFrameNum,1/this.frameInterval_s),this.maxBufferFrameNum=Math.min(this.maxBufferFrameNum,60),this.maxBufferFrameNum=isNaN(this.maxBufferFrameNum)?25:Math.round(this.maxBufferFrameNum),Z.a.v(this.TAG,"maxBufferFrameNum="+this.maxBufferFrameNum));for(var a=(this.seekingTime-this.gopSize_s-.2)*e.inputTimeScale,s=0;s<e.samples.length;s++){var o,u=0,d=e.samples[s];if(o=null!=d.key?d.key?1:0:d.isKeyframe?1:0,!(d.dts<a)){if(-1===this.needIDRPts){if(0===o)continue;this.needIDRPts=d.pts/e.inputTimeScale}if(!(d.dts/e.inputTimeScale<this.lastVideoDts)){this.lastVideoDts=d.dts/e.inputTimeScale,d.units.forEach((function(e){u+=e.data.byteLength+(r?0:4)}));var l=this.Module._malloc(u),c=0;d.units.forEach((function(e){if(!1===r){var n=e.data.byteLength,i=[n>>24&255,n>>16&255,n>>8&255,255&n];t.Module.HEAPU8.set(i,l+c),c+=4}t.Module.HEAPU8.set(e.data,l+c),c+=e.data.byteLength})),c!==u&&console.error("wasm offset !== frameSize"),this.Module._sendAframe(l,u,1,d.dts,d.pts,o),this.lastVideoPts=d.pts/e.inputTimeScale}}}e.samples=[]},t.loadVideo=function(){var e=this;if(!0===this.Module.wasmLoaded)if(0!==this.playerState&&this.unload(),this.playerState=3,this.canvas){this.webglPlayer=new Y(this.canvas,{preserveDrawingBuffer:this.enableWebGLDrawingBuffer});e=this;this.Module.PThread.receiveObjectTransfer=function(t){e.onVideoFrame(t)},this.Module._startDecoding(3),this.displayFirstFrame()}else Z.a.e(this.TAG,"[ER] playVideo error, canvas empty.");else{this.pendingCmd.push((function(){e.loadVideo()}))}},t.createVideoDecoder=function(e,t,n,i){var r=this;if(!0===this.Module.wasmLoaded){this.canvas.width=e,this.canvas.height=t;var a=this.Module._malloc(i.byteLength);this.Module.HEAPU8.set(i,a);this.Module._createVideoDecoder(0,n,a,i.byteLength);this.Module._free(a)}else{this.pendingCmd.push((function(){r.createVideoDecoder(e,t,n,i)}))}},t.resizeCanvas=function(e,t){var n=this;if(!0===this.Module.wasmLoaded)this.Module._createNewSwsCTX(e,t);else{this.pendingCmd.push((function(){n.resizeCanvas(e,t)}))}},t.play=function(){var e=this;if(0!==this.playerState){if(1===this.playerState)return Promise.resolve();if(4!==this.playerState){3===this.playerState&&this.registerVisibilityEvent(!0);var t=void 0;return this.audioElement&&(t=this.audioElement.play()).catch((function(){e.pause()})),this.playerState=1,this.displayLoop(),t}}else this.canplayCb=this.play.bind(this)},t.pause=function(){1==this.playerState&&(this.playerState=2,this.audioElement&&this.audioElement.pause())},t.unload=function(){0!=this.playerState&&(Z.a.v(this.TAG,"unloading"),this.Module._destroyAllDecoders(),this.audioElement&&this.audioElement.pause(),this.registerVisibilityEvent(!1),this.playerState=4,this.webglPlayer=null,this.frameInterval_s=0,this.beginTimeOffset=0,this.compensation=0,this.firstFrame=!0,this.playbackRate=1,this.videoFrameBuf.splice(0,this.videoFrameBuf.length),this.frameCount={decoded:0,dropped:0},this.canplayCb=null,this.lastDisplayPts=0,this.lastVideoPts=1e-4,this.lastVideoDts=-1,this.tabVisible=!0,this.needIDRPts=-1,this.seekingTime=-1,this.gopSize_s=2,this.playerState=0)},t.destroy=function(){Z.a.v(this.TAG,"destroying"),this.unload(),this.detachMediaElement(),this.e=null,this.Module.PThread.terminateAllThreads(),this.Module={},this.Module.wasmLoaded=!1,Z.a.v(this.TAG,"finish destroying")},t.getVolume=function(){return this.audioElement?this.audioElement.volume:0},t.setVolume=function(e){this.audioElement&&(this.audioElement.volume=e)},t.setMuted=function(e){this.audioElement&&(this.audioElement.muted=e)},t.getMuted=function(){return!this.audioElement||this.audioElement.muted},t.setPlaybackRate=function(e){!0===this.hasAudio&&this.audioElement&&(this.audioElement.playbackRate=e),this.playbackRate=e,!1===this.hasAudio&&(this.firstFrame=!0)},t.getPlaybackRate=function(){return!0===this.hasAudio&&this.audioElement?this.audioElement.playbackRate:this.playbackRate},t.displayFirstFrame=function(){if(0!==this.videoFrameBuf.length){var e=this.videoFrameBuf[0],t=new Uint8Array(e.d.buffer);this.renderVideoFrame(t,e.w,e.h),this.canplayCb&&this.canplayCb()}else setTimeout(this.e.displayFirstFrame,0)},t.getState=function(){return this.playerState},t.onVideoFrame=function(e){this.playerState<1||this.playerState>3||(this.videoFrameBuf.push(e),this.videoFrameBuf.length>=this.maxBufferFrameNum&&this.Module._pauseDecoding(1))},t.setFirstAudioPts=function(e){this._firstAudioPts=e},t.getFirstAudioPts=function(){return this._firstAudioPts},t.displayVideoFrame=function(e){if(1!=this.playerState)return!1;if(this.needIDRPts>=0&&this.needIDRPts===e.s&&(this.needIDRPts=-2),-2!==this.needIDRPts)return this.frameCount.dropped+=1,this.frameCount.decoded+=1,!0;if(this.seekingTime>=0&&e.s<this.seekingTime-.1-this.beginTimeOffset)return this.frameCount.dropped+=1,this.frameCount.decoded+=1,!0;var t;if(this.seekingTime=-1,!0===this.hasAudio){var n=this.audioElement.currentTime;t=e.s-n}else{n=this.systemUTCs();this.firstFrame&&(this.firstFrame=!1,this.walltimeOrigin=n,this.framePtsOrigin=e.s),t=n-this.walltimeOrigin-(e.s-this.framePtsOrigin)/this.playbackRate}var i=this.audioElement.playbackRate;if(i<=2&&t<-1*i)return this.frameCount.dropped+=1,this.frameCount.decoded+=1,!0;if(t<=0){if(this.tabVisible){var r=new Uint8Array(e.d.buffer);this.renderVideoFrame(r,e.w,e.h)}return this.frameCount.decoded+=1,!0}return!1},t.systemUTCs=function(){return(new Date).getTime()/1e3},t.displayLoop=function(){1==this.playerState&&(requestAnimationFrame(this.e.displayLoop),this.doDisplayLoop())},t.renderVideoFrame=function(e,t,n){this.canvas.width===t&&this.canvas.height===n||(this.canvas.width=t,this.canvas.height=n),this.webglPlayer.renderFrame(e,t,n,n*t,n*t/4)},t.doDisplayLoop=function(){for(;0!==this.videoFrameBuf.length;){var e=this.videoFrameBuf[0];if(!this.displayVideoFrame(e))break;this.lastDisplayPts=this.videoFrameBuf.shift().s}this.videoFrameBuf.length<this.maxBufferFrameNum/2&&this.lastDisplayPts<this.lastVideoPts-1&&this.Module._startDecoding(1)},t.consumeWatchDog=function(){if(1==this.playerState){this.doDisplayLoop();var e=this;!1===this.tabVisible&&setTimeout((function(){e.consumeWatchDog()}),0)}},t.onVisibleChange=function(e){var t={focus:!0,focusin:!0,pageshow:!0,blur:!1,focusout:!1,pagehide:!1};((e=e||window.event).type in t?t[e.type]:!document.hidden)?this.tabVisible=!0:(this.tabVisible=!1,this.consumeWatchDog())},t.registerVisibilityEvent=function(e){var t="hidden";!1!==e?t in document?document.addEventListener("visibilitychange",this.e.onVisibleChange):(t="mozHidden")in document?document.addEventListener("mozvisibilitychange",this.e.onVisibleChange):(t="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",this.e.onVisibleChange):(t="msHidden")in document?document.addEventListener("msvisibilitychange",this.e.onVisibleChange):"onfocusin"in document?document.onfocusin=document.onfocusout=this.e.onVisibleChange:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=this.e.onVisibleChange:t in document?document.removeEventListener("visibilitychange",this.e.onVisibleChange):(t="mozHidden")in document?document.removeEventListener("mozvisibilitychange",this.e.onVisibleChange):(t="webkitHidden")in document?document.removeEventListener("webkitvisibilitychange",this.e.onVisibleChange):(t="msHidden")in document?document.removeEventListener("msvisibilitychange",this.e.onVisibleChange):"onfocusin"in document?document.onfocusin=document.onfocusout=null:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=null},e.setWasmPath=function(e){X=e},e}(),$=n(5),ee=function(){function e(e){this.handler=$(10),this.handler.addEventListener("message",this._onWorkerMessage.bind(this)),this.handler.postMessage({cmd:"init",data:{currentPath:q,log:Z.a.ENABLE_INFO,num:e,wasmModule:K}}),this.pendingPkt=[],this.pendingCmd=[],this.receiveObjectTransfer=null,this.hvccmeta={},this.decoderState=2,this.workload=0,this.needThreadCB=null}var t=e.prototype;return t._sendAframe=function(e,t,n,i,r,a){var s={data:e,dts:i,pts:r,isKey:a};1==this.ready?this.handler.postMessage({cmd:"workload",data:s},[e.buffer]):this.pendingPkt.push(s),this.workload++},t.sendSpecialPkt=function(e){var t={data:null,isKey:e};1==this.ready?this.handler.postMessage({cmd:"workload",data:t}):this.pendingPkt.push(t)},t._startDecoding=function(){this.ready&&2==this.decoderState&&(this.handler.postMessage({cmd:"control",data:{type:"start"}}),this.decoderState=1)},t._pauseDecoding=function(){this.ready&&1==this.decoderState&&(this.handler.postMessage({cmd:"control",data:{type:"pause"}}),this.decoderState=2)},t._createVideoDecoder=function(e,t,n){this.hvccmeta.timescale=e,this.hvccmeta.hvcc=t;var i={type:"create"};Object.assign(i,this.hvccmeta),this.ready&&(this.handler.postMessage({cmd:"control",data:i},[t.buffer]),this.hvccmeta={})},t.tryNewWorker=function(e){if(!(e.frameCount<10||e.timeSum_ms<1||e.endPts-e.startPts<.001)){var t=e.frameCount/e.timeSum_ms*1e3,n=(e.frameCount-1)/(e.endPts-e.startPts);this.needThreadCB&&this.needThreadCB(n,t)}},t._cleanFifo=function(){this.handler&&this.handler.postMessage({cmd:"control",data:{type:"clean"}}),this.pendingPkt=[]},t._doResize=function(e){var t={cmd:"control",data:{type:"doResize",doResize:e}};this.ready?this.handler.postMessage(t):this.pendingCmd.push(t)},t._createNewSwsCTX=function(e,t){var n={cmd:"control",data:{type:"newsws",w:e,h:t}};this.ready?this.handler.postMessage(n):this.pendingCmd.push(n)},t._destroyAllDecoders=function(){this.handler&&this.handler.terminate(),this.handler=null,this.pendingPkt=[],this.pendingCmd=[],this.receiveObjectTransfer=null,this.hvccmeta={},this.decoderState=2},t._onWorkerMessage=function(e){var t=e.data;switch(t.cmd){case"init":if(URL.revokeObjectURL(this.handler.objectURL),t.data&&(K=t.data),this.ready=!0,this.hvccmeta.hvcc){var n={type:"create"};Object.assign(n,this.hvccmeta),this.handler.postMessage({cmd:"control",data:n},[this.hvccmeta.hvcc.buffer]),this.hvccmeta={}}for(;this.pendingPkt.length>0;){var i=this.pendingPkt.shift();i.data?this.handler.postMessage({cmd:"workload",data:i},[i.data.buffer]):this.handler.postMessage({cmd:"workload",data:i})}for(;this.pendingCmd.length>0;){var r=this.pendingCmd.shift();this.handler.postMessage(r)}break;case"objectTransfer":this.workload=t.remains,this.receiveObjectTransfer(t);break;case"statistics":this.tryNewWorker(t);break;case"error":Z.a.e(this.TAG,"decode errno= "+t.data);break;default:Z.a.w(this.TAG,"unknown cmd")}},e}(),te=function(){function e(e){this._wasmPlayerST=e,this.e={onDecodedFrame:this._onDecodedFrame.bind(this)},this.currentIn=0,this.currentOut=0,this.hvccmeta={},this.lastOutPts=0,this.pool=[],this._createSingleWorker(),1==e._initWorkerNum?this.pool[0].worker.needThreadCB=this._shouldCreate.bind(this):(this._createSingleWorker(),this._createSingleWorker(),this._createSingleWorker())}var t=e.prototype;return t._createSingleWorker=function(){Z.a.v("wasmPlayerST","creating new worker "+this.pool.length);var e=new ee(this.pool.length);this.hvccmeta.hvcc&&e._createVideoDecoder(this.hvccmeta.timescale,new Uint8Array(this.hvccmeta.hvcc),0),e.receiveObjectTransfer=this.e.onDecodedFrame,this.pool.push({worker:e,vfifo:[]})},t._shouldCreate=function(e,t){var n=this._wasmPlayerST.audioElement;n&&(e*=n.playbackRate);var i=Math.ceil(e/t);i=Math.min(4,i);var r=this.pool.length;if(!(r>=i))for(var a=i-r;a--;)this._createSingleWorker()},t._sendAframe=function(e,t,n,i,r,a){var s=this.currentIn;if(a&&(0==s&&this.pool[s].worker.sendSpecialPkt(-321),this.pool[this.currentIn].worker.workload>2))for(var o=1/0,u=0;u<this.pool.length&&(this.pool[u].worker.workload<o&&(this.currentIn=u,o=this.pool[u].worker.workload),!(o<=2));u++);s!==this.currentIn&&this.pool[s].worker.sendSpecialPkt(-123),this.pool[this.currentIn].worker._sendAframe(e,t,n,i,r,a)},t._getAframe=function(e){for(var t=1/0,n=void 0,i=0;i<this.pool.length;i++)for(var r=this.pool[i];;){var a=r.vfifo[0];if(!a)break;if(a.s>e)break;if(!(a.s<this.lastOutPts)){t>a.s&&(t=a.s,n=r);break}r.vfifo.shift(),this._dropAFrame()}if(n){var s=n.vfifo.shift();return this.lastOutPts=s.s,s}},t._dropAFrame=function(){this._wasmPlayerST.frameCount.dropped+=1,this._wasmPlayerST.frameCount.decoded+=1},t._onDecodedFrame=function(e){if(!(this._wasmPlayerST.playerState<1||this._wasmPlayerST.playerState>3)){var t=this.pool[e.n];for(t.vfifo.push(e);t.vfifo[0].s>e.s;)t.vfifo.shift();t.vfifo.length>=this._wasmPlayerST.maxBufferFrameNum&&t.worker._pauseDecoding(1)}},t._startDecoding=function(){this.pool.forEach((function(e){e.worker._startDecoding()}))},t._pauseDecoding=function(){this.pool.forEach((function(e){e.worker._pauseDecoding()}))},t.checkVideoFrameBuf=function(){for(var e=0;e<this.pool.length;e++){var t=this.pool[e];t.vfifo.length<this._wasmPlayerST.maxBufferFrameNum/2&&t.worker._startDecoding()}},t._createVideoDecoder=function(e,t,n){this.hvccmeta.timescale=e,this.hvccmeta.hvcc=t,this.pool.forEach((function(n){n.worker._createVideoDecoder(e,new Uint8Array(t),0)}))},t._cleanFifo=function(){this.pool.forEach((function(e){e.vfifo=[],e.worker._cleanFifo()})),this.lastOutPts=0},t._doResize=function(e){},t._createNewSwsCTX=function(e,t){},t._destroyAllDecoders=function(){this.pool.forEach((function(e){e.worker._destroyAllDecoders(),e.vfifo=[]})),this.pool=[],this.hvccmeta={},this.lastOutPts=0},e}(),ne=function(){function e(e){this.TAG="wasmPlayerST",this.canvas=null,this.audioElement=null,this.webglPlayer=null,this.frameInterval_s=0,this.beginTimeOffset=0,this.compensation=0,this.playerState=0,this.hasAudio=!0,this.playbackRate=1,this.pendingRender=null,this.firstFrame=!0,this.firstPlayFramePts=-1,this.frameCount={decoded:0,dropped:0},this.canplayCb=null,this.lastDisplayPts=0,this.lastVideoPts=1e-4,this.lastVideoDts=-1,this.tabVisible=!0,this.needIDRPts=-1,this.seekingTime=-1,this.gopSize_s=2,this.maxBufferFrameNum=25,this.e={displayFirstFrame:this.displayFirstFrame.bind(this),displayLoop:this.displayLoop.bind(this),onVisibleChange:this.onVisibleChange.bind(this),onPause:this.pause.bind(this)},e&&("number"==typeof e.startPosition&&(this.seekingTime=e.startPosition),null!=e.displayQueueTimeLength&&(this.maxBufferFrameNum=e.displayQueueTimeLength),this.enableWebGLDrawingBuffer=e.enableWebGLDrawingBuffer,Z.a.ENABLE_ERROR=null!=e.ENABLE_ERROR?e.ENABLE_ERROR:Z.a.ENABLE_ERROR,Z.a.ENABLE_INFO=null!=e.ENABLE_INFO?e.ENABLE_INFO:Z.a.ENABLE_INFO,Z.a.ENABLE_WARN=null!=e.ENABLE_WARN?e.ENABLE_WARN:Z.a.ENABLE_WARN,Z.a.ENABLE_DEBUG=null!=e.ENABLE_DEBUG?e.ENABLE_DEBUG:Z.a.ENABLE_DEBUG,Z.a.ENABLE_VERBOSE=null!=e.ENABLE_VERBOSE?e.ENABLE_VERBOSE:Z.a.ENABLE_VERBOSE),this._initWorkerNum=!0===e.isLive?1:4,this.WORKERS=new te(this)}var t=e.prototype;return t.on=function(e,t){this.hasAudio&&this.audioElement&&this.audioElement.addEventListener(e,t,arguments[2],arguments[3])},t.off=function(e,t){this.hasAudio&&this.audioElement&&this.audioElement.removeEventListener(e,t,arguments[2])},t.attachMediaElement=function(e,t){this.canvas=e,this.audioElement=t,this.audioElement.addEventListener("pause",this.e.onPause)},t.detachMediaElement=function(){null!=this.canvas&&(this.canvas=null,null!=this.audioElement&&(this.audioElement.removeEventListener("pause",this.e.onPause),this.audioElement=null))},t.seekto=function(e){this.WORKERS&&(this.seekingTime=e,this.WORKERS._pauseDecoding(1),this.WORKERS._cleanFifo(),this.WORKERS._startDecoding(1),this.needIDRPts=-1,this.lastVideoDts=-1,this.lastDisplayPts=0,this.pendingRender=null,e>=0&&!0===this.hasAudio&&(this.audioElement.currentTime=e))},t.fullscreenListener=function(){this.WORKERS&&(document.fullscreenElement?(Z.a.v(this.TAG,"fullscreenchange entering"),this.WORKERS._doResize(0)):(Z.a.v(this.TAG,"fullscreenchange leaving"),this.WORKERS._doResize(1)))},t.timeNow=function(){if(this.audioElement)return this.audioElement.currentTime},t.notifyGopSize=function(e){e>0&&(this.gopSize_s=e)},t.feedChunk=function(e){var t=e.has_length_header||!1;0===this.frameInterval_s&&(this.frameInterval_s=e.defaultInterval/e.inputTimeScale,this.maxBufferFrameNum=Math.max(this.maxBufferFrameNum,1/this.frameInterval_s),this.maxBufferFrameNum=Math.min(this.maxBufferFrameNum,60),this.maxBufferFrameNum=isNaN(this.maxBufferFrameNum)?25:Math.round(this.maxBufferFrameNum),Z.a.v(this.TAG,"maxBufferFrameNum="+this.maxBufferFrameNum));for(var n=(this.seekingTime-this.gopSize_s-.2)*e.inputTimeScale,i=0;i<e.samples.length;i++){var r,a=0,s=e.samples[i];if(r=null!=s.key?s.key?1:0:s.isKeyframe?1:0,!(s.dts<n)){if(-1===this.needIDRPts){if(0===r)continue;this.needIDRPts=s.pts/e.inputTimeScale,this.firstPlayFramePts<0&&(this.firstPlayFramePts=this.needIDRPts)}if(!(s.dts/e.inputTimeScale<this.lastVideoDts)){this.lastVideoDts=s.dts/e.inputTimeScale,s.units.forEach((function(e){a+=e.data.byteLength+(t?0:4)}));var o=new Uint8Array(a),u=0;s.units.forEach((function(e){if(!1===t){var n=e.data.byteLength,i=[n>>24&255,n>>16&255,n>>8&255,255&n];o.set(i,u),u+=4}o.set(e.data,u),u+=e.data.byteLength})),u!==a&&console.error("wasm offset !== frameSize"),this.WORKERS._sendAframe(o,a,1,s.dts,s.pts,r),this.lastVideoPts=s.pts/e.inputTimeScale}}}e.samples=[]},t.loadVideo=function(){if(0!==this.playerState&&this.unload(),this.playerState=3,this.canvas){this.webglPlayer=new Y(this.canvas,{preserveDrawingBuffer:this.enableWebGLDrawingBuffer});var e=this;this.WORKERS.receiveObjectTransfer=function(t){e.onVideoFrame(t)},this.WORKERS._startDecoding(3),this.displayFirstFrame()}else Z.a.e(this.TAG,"[ER] playVideo error, canvas empty.")},t.createVideoDecoder=function(e,t,n,i){this.canvas.width=e,this.canvas.height=t;var r=new Uint8Array(i.byteLength);r.set(i),this.WORKERS._createVideoDecoder(n,r,i.byteLength)},t.resizeCanvas=function(e,t){},t.play=function(){var e=this;if(0!==this.playerState){if(1===this.playerState)return Promise.resolve();if(4!==this.playerState){3===this.playerState&&this.registerVisibilityEvent(!0);var t=void 0;return this.audioElement&&(t=this.audioElement.play()).catch((function(){e.pause()})),this.playerState=1,this.displayLoop(),t}}else this.canplayCb=!0},t.pause=function(){1==this.playerState&&(this.playerState=2,this.audioElement&&this.audioElement.pause())},t.unload=function(){0!=this.playerState&&(Z.a.v(this.TAG,"unloading"),this.WORKERS._destroyAllDecoders(),this.audioElement&&this.audioElement.pause(),this.registerVisibilityEvent(!1),this.playerState=4,this.webglPlayer=null,this.frameInterval_s=0,this.beginTimeOffset=0,this.compensation=0,this.firstFrame=!0,this.playbackRate=1,this.pendingRender=null,this.frameCount={decoded:0,dropped:0},this.canplayCb=null,this.lastDisplayPts=0,this.lastVideoPts=1e-4,this.lastVideoDts=-1,this.tabVisible=!0,this.needIDRPts=-1,this.seekingTime=-1,this.gopSize_s=2,this.playerState=0)},t.destroy=function(){Z.a.v(this.TAG,"destroying"),this.unload(),this.detachMediaElement(),this.e=null,this.WORKERS=null,Z.a.v(this.TAG,"finish destroying")},t.getVolume=function(){return this.audioElement?this.audioElement.volume:0},t.setVolume=function(e){this.audioElement&&(this.audioElement.volume=e)},t.setMuted=function(e){this.audioElement&&(this.audioElement.muted=e)},t.getMuted=function(){return!this.audioElement||this.audioElement.muted},t.setPlaybackRate=function(e){!0===this.hasAudio&&this.audioElement&&(this.audioElement.playbackRate=e),this.playbackRate=e,!1===this.hasAudio&&(this.firstFrame=!0)},t.getPlaybackRate=function(){return!0===this.hasAudio&&this.audioElement?this.audioElement.playbackRate:this.playbackRate},t.displayFirstFrame=function(){do{if(this.firstPlayFramePts<0)break;if(this.firstPlayFramePts<this.lastDisplayPts)return;var e=this.WORKERS._getAframe(this.firstPlayFramePts);if(!e)break;var t=new Uint8Array(e.d.buffer);return this.renderVideoFrame(t,e.w,e.h),this.pendingRender=e,void(this.canplayCb&&(this.canplayCb=null,this.play()))}while(0);setTimeout(this.e.displayFirstFrame,0)},t.getState=function(){return this.playerState},t.setFirstAudioPts=function(e){this._firstAudioPts=e},t.getFirstAudioPts=function(){return this._firstAudioPts},t.displayVideoFrame=function(e,t){if(1!=this.playerState)return!1;if(this.needIDRPts>=0&&this.needIDRPts===e.s&&(this.needIDRPts=-2),-2!==this.needIDRPts)return this.frameCount.dropped+=1,this.frameCount.decoded+=1,!0;if(this.seekingTime>=0&&e.s<this.seekingTime-.1-this.beginTimeOffset)return this.frameCount.dropped+=1,this.frameCount.decoded+=1,!0;var n;if(this.seekingTime=-1,!0===this.hasAudio){var i=t||this.audioElement.currentTime;n=e.s-i}else{i=this.systemUTCs();this.firstFrame&&(this.firstFrame=!1,this.walltimeOrigin=i,this.framePtsOrigin=e.s),n=i-this.walltimeOrigin-(e.s-this.framePtsOrigin)/this.playbackRate}this.audioElement.playbackRate;if(n<=0){if(this.tabVisible){var r=new Uint8Array(e.d.buffer);this.renderVideoFrame(r,e.w,e.h)}return this.frameCount.decoded+=1,!0}return!1},t.systemUTCs=function(){return(new Date).getTime()/1e3},t.displayLoop=function(){1==this.playerState&&(requestAnimationFrame(this.e.displayLoop),this.doDisplayLoop())},t.renderVideoFrame=function(e,t,n){this.canvas.width===t&&this.canvas.height===n||(this.canvas.width=t,this.canvas.height=n),this.webglPlayer.renderFrame(e,t,n,n*t,n*t/4)},t.doDisplayLoop=function(){for(var e,t=this.audioElement&&this.audioElement.currentTime;this.pendingRender?(e=this.pendingRender,this.pendingRender=null):e=this.WORKERS._getAframe(this.needIDRPts>=0?this.needIDRPts:t),e;)if(this.lastDisplayPts=e.s,!this.displayVideoFrame(e,t)){this.pendingRender=e;break}this.WORKERS.checkVideoFrameBuf()},t.consumeWatchDog=function(){if(1==this.playerState){this.doDisplayLoop();var e=this;!1===this.tabVisible&&setTimeout((function(){e.consumeWatchDog()}),0)}},t.onVisibleChange=function(e){var t={focus:!0,focusin:!0,pageshow:!0,blur:!1,focusout:!1,pagehide:!1};((e=e||window.event).type in t?t[e.type]:!document.hidden)?this.tabVisible=!0:(this.tabVisible=!1,this.consumeWatchDog())},t.registerVisibilityEvent=function(e){var t="hidden";!1!==e?t in document?document.addEventListener("visibilitychange",this.e.onVisibleChange):(t="mozHidden")in document?document.addEventListener("mozvisibilitychange",this.e.onVisibleChange):(t="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",this.e.onVisibleChange):(t="msHidden")in document?document.addEventListener("msvisibilitychange",this.e.onVisibleChange):"onfocusin"in document?document.onfocusin=document.onfocusout=this.e.onVisibleChange:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=this.e.onVisibleChange:t in document?document.removeEventListener("visibilitychange",this.e.onVisibleChange):(t="mozHidden")in document?document.removeEventListener("mozvisibilitychange",this.e.onVisibleChange):(t="webkitHidden")in document?document.removeEventListener("webkitvisibilitychange",this.e.onVisibleChange):(t="msHidden")in document?document.removeEventListener("msvisibilitychange",this.e.onVisibleChange):"onfocusin"in document?document.onfocusin=document.onfocusout=null:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=null},e.setWasmPath=function(e){q=e},e}(),ie=document.currentScript&&document.currentScript.src;ie||(ie=function(){var e;try{({}).b()}catch(t){e=t.stack||t.sourceURL||t.stacktrace}var t=/(?:http|https|file|ws|wss):\/\/.*?\/.+?.js:[0-9]/.exec(e);if(!t[0])return"";var n=t[0];return n.slice(0,n.length-2)}()),J.setWasmPath(ie),ne.setWasmPath(ie);var re=!0;try{new SharedArrayBuffer(1)}catch(e){re=!1}var ae=function(){function e(e){return re?new J(e):new ne(e)}return e.isSupported=function(){if(1==MediaSource.isTypeSupported("video/mp4;codecs=hev1.1.6.L90"))return Z.a.v(null,"detect h265 decoding supported by hardware."),2;var e=!0;return"undefined"==typeof Atomics&&(Z.a.e(null,"Atomics feature is not supported."),e=!1),e?1:0},e}(),se={accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0,isLive:!1,lazyLoad:!0,lazyLoadMaxDuration:120,lazyLoadRecoverDuration:30,enableWebGLDrawingBuffer:!1},oe={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info",MEDIA_ATTACHING:"media_attaching",CODEC_SWITCHING:"codec_switching"},ue={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},de={NETWORK_EXCEPTION:"Exception",NETWORK_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",NETWORK_TIMEOUT:"ConnectingTimeout",NETWORK_UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof",MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:"FormatError",MEDIA_FORMAT_UNSUPPORTED:"FormatUnsupported",MEDIA_CODEC_UNSUPPORTED:"CodecUnsupported"};var le=function(){function e(e){this._config=Object.assign({},se),"object"==typeof e&&Object.assign(this._config,e),this._dontStash=!1,this._emitter=new m.a,this._defaultVolume=1,this._defaultMuted=!1,this.e={onWindowResize:this._onWindowResize.bind(this)},this._pendingMediaElementListener=[],this._pendingVolumechangeListener=[],this._progressChecker=null,this._canvasResizeTimer=0}var t=e.prototype;return t.attachElement=function(e){if(!(e instanceof HTMLDivElement))throw"can not find valid div element.";this._divElement=e,e.scrollHeight&&e.scrollWidth?p.v(this.TAG,"div size: "+e.scrollWidth+"x"+e.scrollHeight):p.w(this.TAG,"can not detect width and height of div element")},t.load=function(e){this._url=e,this._resetStashBuffer(),this._demuxer=new F(this),this._demuxer.onCodecFound=this._onCodecFound.bind(this),this._demuxer.onSeek=this._onSeek.bind(this),this._loader.open({url:e},{from:0,to:-1})},t.play=function(){var e=void 0;return"canvas"===this._elementType?e=this._wasmPlayer.play():"video"===this._elementType&&(e=this._vmediaElement.play()),this._amediaElement&&(e=this._amediaElement.play()),e},t.pause=function(){"canvas"===this._elementType?this._wasmPlayer.pause():"video"===this._elementType&&this._vmediaElement.pause(),this._amediaElement&&this._amediaElement.pause()},t._onCodecFound=function(e){"video"===e?(this._loader.destroy(),this._createVideoElement()):(this._vmsectl=this._createMsectl("v"),this._remuxer=new I(null,this),this._remuxer.bindDataSource(this._demuxer),this._remuxer._onInitSegment=this._onInitSegment.bind(this),this._remuxer._onMediaSegment=this._onMediaSegment.bind(this),this._createCanvasElement())},t._onInitSegment=function(e,t){var n=this;Promise.resolve().then((function(){if("audio"===e){if(!n._amsectl){n._amediaElement=document.createElement("audio");var i=n;for(n._amediaElement.addEventListener("loadedmetadata",(function(){i.play()}),{once:!0}),n._amediaElement.autoplay=!0,n._amediaElement.muted=n._defaultMuted,n._amediaElement.volume=n._defaultVolume,n._vmediaElement&&(n._amediaElement.playbackRate=n._vmediaElement.playbackRate);n._pendingVolumechangeListener.length>0;){var r=n._pendingVolumechangeListener.shift();n._amediaElement.addEventListener(r[0],r[1],r[2],r[3])}n._amsectl=n._createMsectl("a"),n._amsectl.attachMediaElement(n._amediaElement)}n._amsectl.appendInitSegment(t)}else n._vmsectl.appendInitSegment(t)}))},t._onMediaSegment=function(e,t){var n=this;Promise.resolve().then((function(){if("audio"===e)n._amsectl.appendMediaSegment(t);else if(n._vmsectl.appendMediaSegment(t),n._config.lazyLoad){var i=n._vmediaElement.currentTime;t.info.endDts>=1e3*(i+n._config.lazyLoadMaxDuration)&&null==n._progressChecker&&(p.v(n.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),n._suspendTransmuxer())}}))},t._cleanDiv=function(){this._divElement&&(this._vmediaElement&&this._divElement.removeChild(this._vmediaElement),this._wasmPlayer&&this._wasmPlayer.canvas&&this._divElement.removeChild(this._wasmPlayer.canvas))},t._createVideoElement=function(){this._cleanDiv();var e=document.createElement("video");this._divElement.scrollWidth&&(e.width=this._divElement.scrollWidth),this._divElement.scrollHeight&&(e.height=this._divElement.scrollHeight),this._divElement.appendChild(e),this._vmediaElement=e,e.autoplay=!0,e.muted=this._defaultMuted,e.volume=this._defaultVolume;var t=this;for(e.addEventListener("loadedmetadata",(function(){t.play()}),{once:!0}),this._elementType="video";this._pendingMediaElementListener.length>0;){var n=this._pendingMediaElementListener.shift();this._vmediaElement.addEventListener(n[0],n[1],n[2],n[3])}p.v(this.TAG,"create video element"),e.src=this._url,this._emitter.emit(oe.MEDIA_ATTACHING)},t._createCanvasElement=function(){this._cleanDiv();var e=document.createElement("canvas");e.width=1,e.height=1,this._divElement.appendChild(e);var t=document.createElement("audio");this._divElement.appendChild(t),this._vmsectl.attachMediaElement(t),this._vmediaElement=t,this._elementType="canvas",p.v(this.TAG,"create canvas element");var n={ENABLE_ERROR:p.ENABLE_ERROR,ENABLE_INFO:p.ENABLE_INFO,ENABLE_WARN:p.ENABLE_WARN,ENABLE_DEBUG:p.ENABLE_DEBUG,ENABLE_VERBOSE:p.ENABLE_VERBOSE,enableWebGLDrawingBuffer:this._config.enableWebGLDrawingBuffer};this._wasmPlayer=new ae(n),this._wasmPlayer.attachMediaElement(e,t);var i=this;for(t.addEventListener("loadedmetadata",(function(){i.play()}),{once:!0}),t.autoplay=!0,t.volume=this._defaultVolume,t.muted=this._defaultMuted,this._wasmPlayer.play();this._pendingMediaElementListener.length>0;){var r=this._pendingMediaElementListener.shift();this._vmediaElement.addEventListener(r[0],r[1],r[2],r[3])}this._emitter.emit(oe.MEDIA_ATTACHING)},t._onComplete=function(e,t){var n=this;Promise.resolve().then((function(){n._vmsectl&&n._vmsectl.endOfStream()}))},t.on=function(e,t){var n=this;e===oe.MEDIA_INFO?null!=this._mediaInfo&&Promise.resolve().then((function(){n._emitter.emit(oe.MEDIA_INFO,n.mediaInfo)})):e===oe.STATISTICS_INFO&&null!=this._statisticsInfo&&Promise.resolve().then((function(){n._emitter.emit(oe.STATISTICS_INFO,n.statisticsInfo)})),this._emitter.addListener(e,t)},t.off=function(e,t){this._emitter.removeListener(e,t)},t.addEventListener=function(e,t){"volumechange"!==e?this._vmediaElement?this._vmediaElement.addEventListener(e,t,arguments[2],arguments[3]):this._pendingMediaElementListener.push(Array.prototype.slice.call(arguments)):this._amediaElement?this._amediaElement.addEventListener(e,t,arguments[2],arguments[3]):this._pendingVolumechangeListener.push(Array.prototype.slice.call(arguments))},t.removeEventListener=function(e,t){this._amediaElement&&"volumechange"===e&&this._amediaElement.removeEventListener(e,t,arguments[2]),this._vmediaElement&&this._vmediaElement.removeEventListener(e,t,arguments[2])},t._onIOException=function(e,t){p.e(this.TAG,"IOException: type = "+e+", code = "+t.code+", msg = "+t.msg),this._emitter.emit(oe.ERROR,ue.NETWORK_ERROR,e,t)},t.getInnerElement=function(){return"canvas"===this._elementType?{element:this._wasmPlayer.canvas,type:"canvas"}:"video"===this._elementType?{element:this._vmediaElement,type:"video"}:null},t.destroy=function(){this._vmediaElement&&(this.pause(),this._cleanDiv(),"canvas"===this._elementType&&(this._wasmPlayer.detachMediaElement(),this._wasmPlayer&&this._wasmPlayer.destroy(),window.removeEventListener("resize",this.e.onWindowResize)),this._elementType="",this._vmsectl&&(this._vmsectl.destroy(),this._vmsectl=null),this._amsectl&&(this._amsectl.destroy(),this._amsectl=null),this._loader&&(this._loader.destroy(),this._loader=null),this._vmediaElement=null,this._demuxer&&this._demuxer.destroy(),this._remuxer&&this._remuxer.destroy(),this._emitter.removeAllListeners(),this._wasmPlayer=null,this._pendingMediaElementListener=[],this._pendingVolumechangeListener=[],this._defaultVolume=1,this._defaultMuted=!1,clearInterval(this._progressChecker),this._progressChecker=null,this._canvasResizeTimer&&clearTimeout(this._canvasResizeTimer),this._canvasResizeTimer=0)},t._onSeek=function(e,t){null!=t&&this._wasmPlayer&&(this._wasmPlayer.seekto(t),this._vmsectl.seek(-1),this._amsectl&&this._amsectl.seek(-1),this._vmediaElement.currentTime=t,this._amediaElement&&(this._amediaElement.currentTime=t)),clearInterval(this._progressChecker),this._progressChecker=null,this._loader.destroy(),this._loader=null,this._resetStashBuffer(),this._loader.open({url:this._url},{from:e,to:-1}),this.play()},t._resetStashBuffer=function(){this._stashUsed=0,this._stashByteStart=0,this._bufferSize=3145728,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._loader=new B(this._config),this._loader.onDataArrival=this._onDataArrival.bind(this),this._loader.onError=this._onIOException.bind(this),this._loader.onComplete=this._onComplete.bind(this)},t._onDataArrival=function(e,t,n){if(0===this._stashUsed){var i=this._demuxer.parseChunks(e,t);if(i<0)return;if(i<e.byteLength){var r=e.byteLength-i;r>this._bufferSize&&this._expandBuffer(r),new Uint8Array(this._stashBuffer,0,this._bufferSize).set(new Uint8Array(e,i),0),this._stashUsed+=r,this._stashByteStart=t+i}}else{this._stashUsed+e.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+e.byteLength);var a=new Uint8Array(this._stashBuffer,0,this._bufferSize);a.set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength;var s=this._demuxer.parseChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart);if(s<0)return;if(s<this._stashUsed&&s>0){var o=new Uint8Array(this._stashBuffer,s);a.set(o,0)}this._stashUsed-=s,this._stashByteStart+=s}},t._expandBuffer=function(e){for(var t=393216;t+1048576<e;)t*=2;if((t+=1048576)!==this._bufferSize){var n=new ArrayBuffer(t);if(this._stashUsed>0){var i=new Uint8Array(this._stashBuffer,0,this._stashUsed);new Uint8Array(n,0,t).set(i,0)}this._stashBuffer=n,this._bufferSize=t}},t._onWindowResize=function(){var e=this;this._canvasResizeTimer||"canvas"===this._elementType&&(this._canvasResizeTimer=setTimeout((function(){e._divElement&&e._wasmPlayer&&e._divElement.scrollWidth&&e._divElement.scrollHeight&&e._wasmPlayer.resizeCanvas(e._divElement.scrollWidth,e._divElement.scrollHeight),e._canvasResizeTimer=0}),1e3))},t._createMsectl=function(e){var t=this,n=new H(this._config,e);return"v"===e&&n.on(V.UPDATE_END,this._onmseUpdateEnd.bind(this)),n.on(V.BUFFER_FULL,this._onmseBufferFull.bind(this)),n.on(V.ERROR,(function(e){t._emitter.emit(oe.ERROR,ue.MEDIA_ERROR,de.MEDIA_MSE_ERROR,e)})),n},t._onmseUpdateEnd=function(){if(this._config.lazyLoad){for(var e=this._vmediaElement.buffered,t=this._vmediaElement.currentTime,n=0,i=0;i<e.length;i++){var r=e.start(i),a=e.end(i);if(r<=t&&t<a){r,n=a;break}}n>=t+this._config.lazyLoadMaxDuration&&null==this._progressChecker&&(p.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}},t._onmseBufferFull=function(){p.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),null==this._progressChecker&&this._suspendTransmuxer()},t._suspendTransmuxer=function(){this._loader&&(this._loader.pause(),null==this._progressChecker&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),2e3)))},t._checkProgressAndResume=function(){if(this._vmediaElement){for(var e=this._vmediaElement.currentTime,t=this._vmediaElement.buffered,n=!1,i=0;i<t.length;i++){var r=t.start(i),a=t.end(i);if(e>=r&&e<a){e>=a-this._config.lazyLoadRecoverDuration&&(n=!0);break}}n&&(window.clearInterval(this._progressChecker),this._progressChecker=null,n&&(p.v(this.TAG,"Continue loading from paused position"),this._loader.resume()))}else clearInterval(this._progressChecker)},r()(e,[{key:"buffered",get:function(){if(""!==this._elementType)return this._vmediaElement.buffered}},{key:"duration",get:function(){if(""!==this._elementType)return this._vmediaElement.duration}},{key:"volume",get:function(){return"video"===this._elementType?this._vmediaElement.volume/1:this._amediaElement?this._amediaElement.volume/1:this._defaultVolume/1},set:function(e){"video"===this._elementType&&(this._vmediaElement.volume=1*e),this._amediaElement&&(this._amediaElement.volume=1*e),this._defaultVolume=1*e}},{key:"muted",get:function(){return"video"===this._elementType?this._vmediaElement.muted:this._amediaElement?this._amediaElement.muted:this._defaultMuted},set:function(e){"video"===this._elementType&&(this._vmediaElement.muted=e),this._amediaElement&&(this._amediaElement.muted=e),this._defaultMuted=e}},{key:"currentTime",get:function(){return"video"===this._elementType?this._vmediaElement.currentTime:"canvas"===this._elementType?this._wasmPlayer.timeNow():void 0},set:function(e){"number"==typeof e&&("video"===this._elementType?this._vmediaElement.currentTime=e:"canvas"===this._elementType&&this._demuxer.seekto(e))}},{key:"paused",get:function(){var e=this._vmediaElement.paused;return this._amediaElement&&(e=e||this._amediaElement.paused),e}},{key:"playbackRate",get:function(){if(this._vmediaElement)return this._vmediaElement.playbackRate},set:function(e){this._vmediaElement&&(this._vmediaElement.playbackRate=e),this._amediaElement&&(this._amediaElement.playbackRate=e)}}]),e}(),ce={createPlayer:function(e){return new le(e)}};ce.LoggingControl=W,ce.version="v2.3",ce.Events=oe,ce.ErrorTypes=ue,ce.ErrorDetails=de;t.default=ce}]).default}));
//# sourceMappingURL=mp4.min.js.map